<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Company Profile</title>
    <link rel="icon" href="/favicon.ico">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; scroll-behavior: smooth; }
        .nav-link.active-tab { border-bottom-width: 2px; border-color: #4F46E5; color: #4F46E5; font-weight: 600; background-color: #EEF2FF; }
        .nav-link { @apply px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-100 hover:text-gray-900; }
        .profile-section-title { @apply text-xl font-semibold text-gray-800 mb-4 pb-2 border-b border-gray-200; }
        .detail-item { @apply flex flex-col sm:flex-row py-2; }
        .detail-label { @apply sm:w-1/3 font-medium text-gray-600 mb-1 sm:mb-0; }
        .detail-value { @apply sm:w-2/3 text-gray-800; }
        .config-block { @apply mt-3 p-4 border border-gray-200 rounded-md bg-gray-50; }
        .form-input, .form-select, .form-textarea, .form-checkbox { @apply mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm transition duration-150 ease-in-out; }
        .form-checkbox { @apply w-auto h-4 text-indigo-600; } 
        .form-label { @apply block text-sm font-medium text-gray-700; }
        .form-check-label { @apply ml-2 text-sm text-gray-700; }
        .tab-button { padding: 0.5rem 1rem; font-weight: 500; font-size: 0.875rem; line-height: 1.25rem; border-top-left-radius: 0.5rem; border-top-right-radius: 0.5rem; transition-property: color, background-color, border-color, text-decoration-color, fill, stroke; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 150ms; cursor: pointer; }
        .tab-button:focus { outline: 2px solid transparent; outline-offset: 2px; }
        .tab-button-active { background-color: #4F46E5; color: white; }
        .tab-button-inactive { background-color: #E5E7EB; color: #374151; }
        .tab-button-inactive:hover { background-color: #D1D5DB; }
        .tab-content-item { @apply p-0 pt-6; } 
        .tab-content-item.hidden { display: none; }
        .notes-textarea { @apply w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition duration-150 ease-in-out; min-height: 150px; }
        .wider-textbox { max-width: 800px; width: 100%; }
        .note-card { @apply bg-white p-4 rounded-lg shadow border border-gray-200 mb-4; }
        .note-card.pinned { @apply bg-yellow-50 border-yellow-300; }
        .note-content { @apply text-gray-800 whitespace-pre-wrap; }
        .note-timestamps { @apply text-xs text-gray-500 mt-2; }
        .note-actions { @apply mt-3 flex items-center space-x-3; }
        .note-action-button { @apply text-xs text-indigo-600 hover:text-indigo-800 font-medium; }
        .note-action-button .fa-thumbtack.pinned-icon { color: #F59E0B; }
        .status-badge { @apply px-2.5 py-0.5 rounded-full text-xs font-medium; }
        .status-active { @apply bg-green-100 text-green-800; }
        .status-inactive { @apply bg-red-100 text-red-800; }
        #agent-setup-content .form-input, #agent-setup-content .form-select, #agent-setup-content .form-textarea { @apply rounded-xl border-gray-200 shadow-sm focus:ring-2 focus:ring-indigo-600 focus:border-indigo-600 transition-all duration-200 wider-textbox; }
        #agent-setup-content .form-input:focus, #agent-setup-content .form-select:focus, #agent-setup-content .form-textarea:focus { box-shadow: 0 0 10px rgba(99, 102, 241, 0.5); }
        #agent-setup-content .form-button-agent-setup { @apply px-4 py-2 rounded-xl text-sm font-medium bg-gradient-to-r from-indigo-500 to-indigo-600 text-white hover:from-indigo-600 hover:to-indigo-700 transition-all duration-200; }
        #agent-setup-content .remove-button-agent-setup { @apply bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700; }
        #agent-setup-content .agent-setup-section-container { transition: max-height 0.4s ease-in-out, opacity 0.3s ease-in-out .1s, padding 0.3s ease-in-out, margin 0.3s ease-in-out; overflow: hidden; border: 1px solid #e5e7eb; border-radius: 0.75rem; background-color: #f9fafb; margin-bottom: 1.5rem; }
        #agent-setup-content .agent-setup-section-container.hidden-by-mode { max-height: 0 !important; opacity: 0 !important; padding: 0 !important; margin: 0 !important; border: none !important; overflow: hidden; }
        #agent-setup-content .agent-setup-section-header { @apply text-lg font-semibold text-gray-700 p-4 flex items-center justify-between cursor-pointer hover:bg-gray-100 transition-colors duration-200 rounded-t-xl; }
        #agent-setup-content .agent-setup-section-header i.fa-chevron-down, #agent-setup-content .agent-setup-section-header i.fa-chevron-up { transition: transform 0.3s ease-in-out; }
        #agent-setup-content .agent-setup-section-header i.fa-chevron-up { transform: rotate(180deg); }
        #agent-setup-content .section-content { @apply p-4 pt-0 transition-all duration-300 ease-in-out; max-height: 2000px; opacity: 1; overflow-y: auto; }
        #agent-setup-content .section-content.collapsed { max-height: 0; opacity: 0; padding-top: 0; padding-bottom: 0; margin-top: 0; }
        #agent-setup-content .protocol-section { transition: max-height 0.3s ease-in-out, opacity 0.2s ease-in-out, padding-top 0.3s ease-in-out, padding-bottom 0.3s ease-in-out; overflow: hidden; max-height: 500px; padding-top: 0.5rem; padding-bottom: 0.5rem; }
        #agent-setup-content .protocol-section.collapsed { max-height: 0; opacity: 0; padding-top: 0; padding-bottom: 0; margin-top:0; }
        #agent-setup-content .disabled-input { @apply opacity-50 cursor-not-allowed bg-gray-200; }
        
        /* Blue placeholder text for default content vs black for developer-edited content */
        .default-placeholder-text {
            color: #3B82F6 !important; /* Blue color for default/placeholder text */
            font-style: italic;
        }
        .developer-edited-text {
            color: #1F2937 !important; /* Black color for developer-customized text */
            font-style: normal;
        }
        #agent-setup-content .form-input.has-default-content,
        #agent-setup-content .form-textarea.has-default-content {
            color: #3B82F6 !important;
            font-style: italic;
        }
        #agent-setup-content .form-input.has-edited-content,
        #agent-setup-content .form-textarea.has-edited-content {
            color: #1F2937 !important;
            font-style: normal;
            font-weight: 500;
        }
        /* Placeholder text styling for inputs */
        #agent-setup-content .form-input::placeholder,
        #agent-setup-content .form-textarea::placeholder {
            color: #3B82F6 !important;
            font-style: italic;
            opacity: 0.8;
        }
        
        .contact-block-view { @apply mt-3 pt-3 border-t border-gray-200; }
        .contact-block-view .detail-item:last-child { padding-bottom: 0; }
        .scheduling-rule-daily-hours-header { @apply grid grid-cols-4 gap-x-3 mb-1 px-2 text-xs font-medium text-gray-500; }
        .scheduling-rule-daily-hours-row { @apply grid grid-cols-4 gap-x-3 items-center p-2 hover:bg-gray-100 rounded-md; }
        #toast-notification { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background-color: #333; color: white; padding: 10px 20px; border-radius: 5px; z-index: 1000; opacity: 0; transition: opacity 0.5s ease-in-out; }
        #toast-notification.show { opacity: 1; }
        #toast-notification.success { background-color: #4CAF50; }
        #toast-notification.error { background-color: #f44336; }
        @media (min-width: 768px) { .wider-textbox { max-width: 800px; } }
        @media (max-width: 767px) { .wider-textbox { max-width: 100%; } }
    </style>
</head>
<body class="bg-gray-100">
    <div id="app" class="flex flex-col min-h-screen">
        <header class="bg-white shadow-md sticky top-0 z-40">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex items-center justify-between h-16">
                    <div class="flex-shrink-0">
                        <a href="/index.html" class="text-2xl font-bold text-indigo-600">
                            <i class="fas fa-tachometer-alt mr-2"></i>Admin Dashboard
                        </a>
                    </div>
                    <nav class="hidden md:flex space-x-4 items-center">
                        <a href="/index.html" class="nav-link" id="nav-home">Home</a>
                        <a href="/directory.html" class="nav-link" id="nav-directory">Directory</a>
                        <a href="/add-company.html" class="nav-link" id="nav-add-company">Add Company</a>
                        <a href="/trade-category-management.html" class="nav-link" id="nav-trade-categories">Trade Categories</a>
                        <a href="/company-profile.html" class="nav-link" id="nav-company-profile">Company Profile</a>
                    </nav>
                    <div class="md:hidden flex items-center">
                        <button id="mobile-menu-button" class="text-gray-500 hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500">
                            <span class="sr-only">Open main menu</span>
                            <i class="fas fa-bars text-2xl"></i>
                        </button>
                    </div>
                </div>
            </div>
            <div id="mobile-menu" class="md:hidden hidden">
                <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                    <a href="/index.html" class="block nav-link text-base">Home</a>
                    <a href="/directory.html" class="block nav-link text-base">Directory</a>
                    <a href="/add-company.html" class="block nav-link text-base">Add Company</a>
                    <a href="/trade-category-management.html" class="block nav-link text-base">Trade Categories</a>
                    <a href="/company-profile.html" class="block nav-link text-base">Company Profile</a>
                </div>
            </div>
        </header>

        <main class="flex-grow container mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="bg-white p-6 md:p-8 rounded-lg shadow-lg">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-1">
                    <div> 
                        <h1 class="text-3xl font-semibold text-gray-800" id="company-name-header">Loading...</h1>
                        <p id="company-id-subheader" class="text-xs text-gray-500 mt-1">ID: Loading...</p> 
                    </div>
                    <div class="flex items-center gap-x-3 mt-3 md:mt-0">
                         <span id="company-status-badge" class="status-badge mr-3">Status</span> 
                        <button id="edit-profile-button" class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-150 ease-in-out flex items-center">
                            <i class="fas fa-edit mr-2"></i>Edit Profile
                        </button>
                    </div>
                </div>
                <hr class="mb-6 mt-3">

                <div class="mb-6">
                    <div class="border-b border-gray-300">
                        <nav class="-mb-px flex flex-wrap space-x-1" aria-label="Tabs">
                            <button class="tab-button tab-button-active" id="tab-overview" data-tab="overview">
                                <i class="fas fa-info-circle mr-1"></i>Overview
                            </button>
                            <button class="tab-button tab-button-inactive" id="tab-config" data-tab="config">
                                <i class="fas fa-cogs mr-1"></i>Configuration
                            </button>
                            <button class="tab-button tab-button-inactive" id="tab-notes" data-tab="notes">
                                <i class="fas fa-sticky-note mr-1"></i>Notes
                            </button>
                             <button class="tab-button tab-button-inactive" id="tab-calendar-settings" data-tab="calendar-settings">
                                <i class="fas fa-calendar-alt mr-1"></i>Calendar Settings
                            </button>
                            <button class="tab-button tab-button-inactive" id="tab-ai-settings" data-tab="ai-settings">
                                <i class="fas fa-robot mr-1"></i>AI Settings
                            </button>
                            <button class="tab-button tab-button-inactive" id="tab-ai-voice" data-tab="ai-voice">
                                <i class="fas fa-microphone-alt mr-1"></i>AI Voice Settings
                            </button>
                            <button class="tab-button tab-button-inactive" id="tab-personality-responses" data-tab="personality-responses">
                                <i class="fas fa-comment-dots mr-1"></i>Agent Personality Responses
                            </button>
                            <button class="tab-button tab-button-inactive" id="tab-agent-setup" data-tab="agent-setup">
                                <i class="fas fa-user-cog mr-1"></i>Agent Setup
                            </button>
                            <button class="tab-button tab-button-inactive" id="tab-ai-agent-setup" data-tab="ai-agent-setup">
                                <i class="fas fa-brain mr-1"></i>AI Agent Setup
                            </button>
                        </nav>
                    </div>
                </div>

                <div id="tab-content-area">
                    <div id="overview-content" class="tab-content-item">
                        <section class="profile-section bg-transparent shadow-none p-0">
                            <div class="flex justify-between items-center mb-2">
                                <h2 class="profile-section-title !mb-0"><i class="fas fa-building mr-2 text-indigo-600"></i>Company Information</h2>
                                </div>
                            <div id="company-details-view">
                                <div class="detail-item"><span class="detail-label">Company Name:</span><span class="detail-value" id="company-name-view">Loading...</span></div> 
                                <div class="detail-item"><span class="detail-label">Owner:</span><span class="detail-value" id="company-owner-view">Loading...</span></div>
                                <div class="detail-item"><span class="detail-label">Owner Email:</span><span class="detail-value" id="company-owner-email-view">Loading...</span></div>
                                <div class="detail-item"><span class="detail-label">Owner Phone:</span><span class="detail-value" id="company-owner-phone-view">Loading...</span></div>
                                <div class="detail-item"><span class="detail-label">Primary Contact:</span><span class="detail-value" id="company-contact-name-view">Loading...</span></div>
                                <div class="detail-item"><span class="detail-label">Contact Email:</span><span class="detail-value" id="company-contact-email-view">Loading...</span></div>
                                <div class="detail-item"><span class="detail-label">Contact Phone:</span><span class="detail-value" id="company-contact-phone-view">Loading...</span></div>
                                <div class="detail-item"><span class="detail-label">Address:</span><span class="detail-value" id="company-address-view">Loading...</span></div>
                                <div id="additional-contacts-view-container" class="mt-4"></div>
                            </div>
                            <div id="company-details-edit-form" class="hidden mt-4">
                                <p class="text-gray-500"><em>Loading edit form...</em></p>
                            </div>
                        </section>
                    </div>

                    <div id="config-content" class="tab-content-item hidden">
                        <section class="profile-section bg-transparent shadow-none p-0">
                            <h2 class="profile-section-title"><i class="fas fa-cogs mr-2 text-indigo-600"></i>Service Configuration</h2>
                            <form id="config-settings-form">
                                <div class="config-block">
                                    <h3 class="font-semibold text-gray-700 mb-2">Twilio Integration Credentials</h3>
                                    <p class="text-sm text-gray-500 mb-3">Enter the Twilio credentials that this company's AI agent will use.</p>
                                    <div class="space-y-3">
                                        <div>
                                            <label for="twilioAccountSid" class="form-label">Account SID</label>
                                            <input type="text" id="twilioAccountSid" name="twilioAccountSid" class="form-input wider-textbox" placeholder="ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxx">
                                        </div>
                                        <div>
                                            <label for="twilioAuthToken" class="form-label">Auth Token</label>
                                            <input type="password" id="twilioAuthToken" name="twilioAuthToken" class="form-input wider-textbox" placeholder="Enter Auth Token">
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Phone Numbers Management -->
                                <div class="config-block mt-6">
                                    <div class="flex justify-between items-center mb-3">
                                        <h3 class="font-semibold text-gray-700">Twilio Phone Numbers</h3>
                                        <button type="button" id="addPhoneNumberBtn" class="bg-indigo-600 hover:bg-indigo-700 text-white text-sm px-3 py-1 rounded-md flex items-center">
                                            <i class="fas fa-plus mr-1"></i>Add Number
                                        </button>
                                    </div>
                                    <p class="text-sm text-gray-500 mb-3">Manage all Twilio phone numbers available for this company's AI agents.</p>
                                    
                                    <!-- Phone Numbers List -->
                                    <div id="phoneNumbersList" class="space-y-3">
                                        <!-- Primary Phone Number (Default) -->
                                        <div class="phone-number-item border border-gray-200 rounded-lg p-4 bg-gray-50">
                                            <div class="flex items-center justify-between">
                                                <div class="flex-1 grid grid-cols-1 md:grid-cols-3 gap-4">
                                                    <div>
                                                        <label class="form-label text-sm">Phone Number (E.164 format)</label>
                                                        <input type="tel" name="phoneNumber" class="form-input" placeholder="+12395551212" value="">
                                                    </div>
                                                    <div>
                                                        <label class="form-label text-sm">Friendly Name</label>
                                                        <input type="text" name="friendlyName" class="form-input" placeholder="Main Business Line" value="Primary Number">
                                                    </div>
                                                    <div>
                                                        <label class="form-label text-sm">Status</label>
                                                        <select name="status" class="form-select">
                                                            <option value="active" selected>Active</option>
                                                            <option value="inactive">Inactive</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="ml-4 flex items-center space-x-2">
                                                    <span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full">Primary</span>
                                                    <button type="button" class="text-red-600 hover:text-red-800" onclick="removePhoneNumber(this)" title="Remove">
                                                        <i class="fas fa-trash text-sm"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Add Phone Number Template (Hidden) -->
                                    <template id="phoneNumberTemplate">
                                        <div class="phone-number-item border border-gray-200 rounded-lg p-4">
                                            <div class="flex items-center justify-between">
                                                <div class="flex-1 grid grid-cols-1 md:grid-cols-3 gap-4">
                                                    <div>
                                                        <label class="form-label text-sm">Phone Number (E.164 format)</label>
                                                        <input type="tel" name="phoneNumber" class="form-input" placeholder="+12395551212">
                                                    </div>
                                                    <div>
                                                        <label class="form-label text-sm">Friendly Name</label>
                                                        <input type="text" name="friendlyName" class="form-input" placeholder="e.g., Emergency Line, Sales Line">
                                                    </div>
                                                    <div>
                                                        <label class="form-label text-sm">Status</label>
                                                        <select name="status" class="form-select">
                                                            <option value="active" selected>Active</option>
                                                            <option value="inactive">Inactive</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="ml-4 flex items-center space-x-2">
                                                    <button type="button" class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full hover:bg-blue-200" onclick="setPrimaryNumber(this)" title="Set as Primary">
                                                        Set Primary
                                                    </button>
                                                    <button type="button" class="text-red-600 hover:text-red-800" onclick="removePhoneNumber(this)" title="Remove">
                                                        <i class="fas fa-trash text-sm"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </template>
                                </div>
                                <div class="config-block mt-6">
                                    <h3 class="font-semibold text-gray-700 mb-3">SMS Notification Settings</h3>
                                    <div class="space-y-2">
                                        <label class="flex items-center">
                                            <input type="checkbox" id="smsJobAlerts" name="smsJobAlerts" class="form-checkbox h-5 w-5 text-indigo-600 rounded">
                                            <span class="form-check-label">Enable SMS for new job alerts</span>
                                        </label>
                                        <label class="flex items-center">
                                            <input type="checkbox" id="smsCustomerReplies" name="smsCustomerReplies" class="form-checkbox h-5 w-5 text-indigo-600 rounded">
                                            <span class="form-check-label">Enable SMS for customer replies</span>
                                        </label>
                                        <label class="flex items-center">
                                            <input type="checkbox" id="smsAppointmentReminders" name="smsAppointmentReminders" class="form-checkbox h-5 w-5 text-indigo-600 rounded">
                                            <span class="form-check-label">Enable SMS for appointment reminders</span>
                                        </label>
                                    </div>
                                </div>
                                
                                <!-- Webhook Configuration Reference -->
                                <div class="config-block mt-6">
                                    <div class="flex justify-between items-center mb-3">
                                        <h3 class="font-semibold text-gray-700">Twilio Webhook Configuration</h3>
                                        <button type="button" id="toggleWebhookInfo" class="text-indigo-600 hover:text-indigo-800 text-sm flex items-center">
                                            <i class="fas fa-info-circle mr-1"></i>Show Webhook URLs
                                        </button>
                                    </div>
                                    <p class="text-sm text-gray-500 mb-3">Use these webhook URLs in your Twilio Console for phone number configuration.</p>
                                    
                                    <div id="webhookInfoPanel" class="hidden">
                                        <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 space-y-4">
                                            <!-- Voice Webhook -->
                                            <div class="webhook-item">
                                                <div class="flex justify-between items-center mb-2">
                                                    <h4 class="text-sm font-medium text-gray-900">🎤 Voice Webhook (Primary)</h4>
                                                    <button type="button" class="copy-webhook-btn text-xs bg-blue-100 hover:bg-blue-200 text-blue-700 px-2 py-1 rounded" data-webhook="https://clientsvia-backend.onrender.com/api/twilio/voice">
                                                        <i class="fas fa-copy mr-1"></i>Copy
                                                    </button>
                                                </div>
                                                <div class="bg-white border rounded p-2 font-mono text-sm text-gray-800">
                                                    https://clientsvia-backend.onrender.com/api/twilio/voice
                                                </div>
                                                <p class="text-xs text-gray-600 mt-1">Configure this in Twilio Console → Phone Numbers → Voice Configuration</p>
                                            </div>
                                            
                                            <!-- Speech Webhook -->
                                            <div class="webhook-item">
                                                <div class="flex justify-between items-center mb-2">
                                                    <h4 class="text-sm font-medium text-gray-900">🗣️ Speech Recognition</h4>
                                                    <button type="button" class="copy-webhook-btn text-xs bg-blue-100 hover:bg-blue-200 text-blue-700 px-2 py-1 rounded" data-webhook="https://clientsvia-backend.onrender.com/api/twilio/handle-speech">
                                                        <i class="fas fa-copy mr-1"></i>Copy
                                                    </button>
                                                </div>
                                                <div class="bg-white border rounded p-2 font-mono text-sm text-gray-800">
                                                    https://clientsvia-backend.onrender.com/api/twilio/handle-speech
                                                </div>
                                                <p class="text-xs text-gray-600 mt-1">Used internally for AI speech processing</p>
                                            </div>
                                            
                                            <!-- Additional Webhooks -->
                                            <div class="webhook-item">
                                                <div class="flex justify-between items-center mb-2">
                                                    <h4 class="text-sm font-medium text-gray-900">⚡ Additional Endpoints</h4>
                                                    <span class="text-xs text-gray-500">For advanced configurations</span>
                                                </div>
                                                <div class="space-y-2">
                                                    <div class="flex justify-between items-center">
                                                        <span class="font-mono text-xs text-gray-700">../api/twilio/partial-speech</span>
                                                        <button type="button" class="copy-webhook-btn text-xs bg-gray-100 hover:bg-gray-200 text-gray-600 px-2 py-1 rounded" data-webhook="https://clientsvia-backend.onrender.com/api/twilio/partial-speech">
                                                            <i class="fas fa-copy"></i>
                                                        </button>
                                                    </div>
                                                    <div class="flex justify-between items-center">
                                                        <span class="font-mono text-xs text-gray-700">../api/twilio/speech-timing-test</span>
                                                        <button type="button" class="copy-webhook-btn text-xs bg-gray-100 hover:bg-gray-200 text-gray-600 px-2 py-1 rounded" data-webhook="https://clientsvia-backend.onrender.com/api/twilio/speech-timing-test">
                                                            <i class="fas fa-copy"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <!-- Configuration Instructions -->
                                            <div class="mt-4 p-3 bg-blue-50 border border-blue-200 rounded">
                                                <h5 class="text-sm font-medium text-blue-900 mb-2">📋 Quick Setup Instructions:</h5>
                                                <ol class="text-xs text-blue-800 space-y-1">
                                                    <li>1. Go to <a href="https://console.twilio.com" target="_blank" class="underline hover:no-underline">Twilio Console</a></li>
                                                    <li>2. Navigate to Phone Numbers → Manage → Active Numbers</li>
                                                    <li>3. Click on your phone number</li>
                                                    <li>4. Set Voice Configuration webhook to the Voice Webhook URL above</li>
                                                    <li>5. Set HTTP method to POST</li>
                                                    <li>6. Save configuration</li>
                                                </ol>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="mt-8 pt-5 border-t border-gray-200">
                                    <button type="submit" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-6 rounded-lg shadow-md transition duration-150 ease-in-out">
                                        <i class="fas fa-save mr-2"></i>Save Configuration
                                    </button>
                                </div>
                            </form>
                        </section>
                    </div>

                    <div id="notes-content" class="tab-content-item hidden">
                        <section class="profile-section bg-transparent shadow-none p-0"> 
                            <h2 class="profile-section-title"><i class="fas fa-sticky-note mr-2 text-indigo-600"></i>Company Notes</h2>
                            <div id="add-note-area" class="mb-6">
                                <textarea id="new-note-textarea" class="notes-textarea wider-textbox" placeholder="Type your new note here..."></textarea>
                                <button id="add-new-note-button" class="mt-3 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-150 ease-in-out">
                                    <i class="fas fa-plus-circle mr-2"></i>Add Note
                                </button>
                            </div>
                            <div id="notes-display-area">
                                <p class="text-gray-500 italic text-center py-4">Notes will appear here.</p>
                            </div>
                        </section>
                    </div>
                    
                    <div id="calendar-settings-content" class="tab-content-item hidden">
                         <section class="profile-section bg-transparent shadow-none p-0">
                            <h2 class="profile-section-title"><i class="fas fa-calendar-alt mr-2 text-indigo-600"></i>Google Calendar Integration</h2>
                            <div id="gcal-status-container" class="p-4 rounded-lg border bg-gray-50 mb-6">
                                 <!-- Status content will be dynamically inserted here -->
                                 <p class="text-gray-500">Checking connection status...</p>
                            </div>

                            <div id="gcal-calendars-list-container" class="hidden">
                                <h3 class="text-lg font-semibold text-gray-700 mb-2">Available Calendars</h3>
                                <p class="text-sm text-gray-500 mb-4">These calendars can be selected within the 'Service Scheduling Rules' in the Agent Setup tab. Only calendars you have 'write' access to are shown.</p>
                                <div id="gcal-calendars-list" class="space-y-3 border rounded-lg p-4 bg-white max-h-96 overflow-y-auto">
                                    <!-- Calendar list will be dynamically inserted here -->
                                    <p class="text-gray-500">Loading calendars...</p>
                                </div>
                            </div>
                         </section>
                    </div>

                    <div id="ai-settings-content" class="tab-content-item hidden">
                        <section class="profile-section bg-transparent shadow-none p-0">
                            <h2 class="profile-section-title"><i class="fas fa-robot mr-2 text-indigo-600"></i>AI Core Parameters</h2>
                            <p class="text-sm text-gray-500 mb-4">High-level AI settings. More detailed scripting is in "Agent Setup".</p>
                            <form id="ai-settings-form">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                                    <div>
                                        <label for="aiModel" class="form-label">AI Model Engine</label>
                                        <select id="aiModel" name="aiModel" class="form-select">
                                            <option value="gemini-2.5-flash">Gemini 2.5 Flash (High Speed)</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label for="aiCorePersonality" class="form-label">AI Base Personality</label>
                                        <select id="aiCorePersonality" name="aiCorePersonality" class="form-select">
                                            <option value="friendly">Friendly & Empathetic</option>
                                            <option value="formal">Formal & Professional</option>
                                            <option value="efficient">Quick & Efficient</option>
                                            <option value="witty">Witty & Engaging</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="mt-4">
                                    <label for="knowledgeBaseSource" class="form-label">External Knowledge Base URL/ID (Optional)</label>
                                    <input type="text" id="knowledgeBaseSource" name="knowledgeBaseSource" class="form-input wider-textbox" placeholder="e.g., FAQ page URL, Document ID">
                                </div>
                                <div class="mt-4">
                                    <label class="flex items-center">
                                        <input type="checkbox" id="llmFallbackEnabled" name="llmFallbackEnabled" class="form-checkbox">
                                        <span class="form-check-label">Enable AI Model Fallback (Gemini)</span>
                                    </label>
                                </div>
                                <div class="mt-4" id="escalationMessageContainer">
                                    <label for="customEscalationMessage" class="form-label">Custom Escalation Message</label>
                                    <textarea id="customEscalationMessage" name="customEscalationMessage" class="form-textarea wider-textbox" rows="3" placeholder="I’m unable to answer that, let me connect you to a team member who can help."></textarea>
                                </div>
                                <div class="mt-6 border-t border-gray-200 pt-6">
                                    <h3 class="text-md font-medium text-gray-700 mb-3">Conversation Flow Settings</h3>
                                    <div class="space-y-3">
                                        <label class="flex items-start">
                                            <input type="checkbox" id="bargeIn" name="bargeIn" class="form-checkbox mt-1">
                                            <div class="ml-2">
                                                <span class="form-check-label font-medium">Allow Caller Interruption (Barge-In)</span>
                                                <p class="text-xs text-gray-500 mt-1">
                                                    <strong>ON:</strong> Callers can interrupt the agent while speaking (may cause choppy conversations)<br>
                                                    <strong>OFF:</strong> Agent finishes speaking before listening (natural conversation flow)
                                                </p>
                                            </div>
                                        </label>
                                    </div>
                                </div>
                                <div class="mt-6 border-t border-gray-200 pt-6">
                                    <h3 class="text-md font-medium text-gray-700 mb-3">Advanced Options</h3>
                                    <div class="space-y-2">
                                        <label class="flex items-center">
                                            <input type="checkbox" id="sentimentAnalysis" name="sentimentAnalysis" class="form-checkbox">
                                            <span class="form-check-label">Enable Sentiment Analysis</span>
                                        </label>
                                        <label class="flex items-center">
                                            <input type="checkbox" id="dataLogging" name="dataLogging" class="form-checkbox" checked>
                                            <span class="form-check-label">Enable Interaction Logging (for improvements)</span>
                                        </label>
                                    </div>
                                </div>
                                <div class="mt-8 pt-5 border-t border-gray-200">
                                    <button type="submit" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-6 rounded-lg shadow-md transition duration-150 ease-in-out">
                                        <i class="fas fa-save mr-2"></i>Save AI Core Settings
                                    </button>
                                </div>
                            </form>
                        </section>
                    </div>

                    <div id="ai-voice-content" class="tab-content-item hidden">
                        <section class="profile-section bg-transparent shadow-none p-0">
                            <h2 class="profile-section-title"><i class="fas fa-microphone-alt mr-2 text-indigo-600"></i>AI Voice Settings</h2>
                            <form id="elevenlabs-settings-form" class="mb-6">
                                <div class="mb-4">
                                    <label for="elevenlabsApiKey" class="form-label">ElevenLabs API Key</label>
                                    <input type="text" id="elevenlabsApiKey" name="elevenlabsApiKey" class="form-input wider-textbox" placeholder="Enter your ElevenLabs API Key">
                                </div>
                                <div class="mb-4">
                                    <label for="elevenlabsVoice" class="form-label">Voice Selection</label>
                                    <select id="elevenlabsVoice" name="elevenlabsVoice" class="form-select wider-textbox">
                                        <option value="">Select a voice</option>
                                        <option value="Rachel">Rachel</option>
                                        <option value="Domi">Domi</option>
                                        <option value="Bella">Bella</option>
                                        <option value="Antoni">Antoni</option>
                                        <option value="Elli">Elli</option>
                                        <option value="Josh">Josh</option>
                                        <option value="Arnold">Arnold</option>
                                        <option value="Adam">Adam</option>
                                        <option value="Sam">Sam</option>
                                    </select>
                                </div>
                                <div class="mb-4">
                                    <label for="elevenlabsTestPhrase" class="form-label">Test Phrase</label>
                                    <input type="text" id="elevenlabsTestPhrase" name="elevenlabsTestPhrase" class="form-input wider-textbox" placeholder="Type a phrase to test voice playback" value="Hello, this is a test from ElevenLabs!">
                                </div>
                                <button type="button" id="testElevenLabsVoiceBtn" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-6 rounded-lg shadow-md transition duration-150 ease-in-out">Listen to Test Phrase</button>
                            <button type="submit" class="ml-4 bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-6 rounded-lg shadow-md transition duration-150 ease-in-out">Save ElevenLabs Settings</button>
                        </form>

                        <!-- Agent Performance Controls Section -->
                        <section class="profile-section bg-gray-50 border border-gray-200 rounded-lg p-6 mt-8">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                                <i class="fas fa-tachometer-alt mr-2 text-indigo-600"></i>Agent Performance Controls
                                <span class="ml-2 text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full">Advanced</span>
                            </h3>
                            <p class="text-sm text-gray-600 mb-6">Fine-tune agent response timing and behavior for optimal call experience.</p>
                            
                            <form id="agent-performance-form" class="space-y-6">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <!-- Speech Confidence Threshold -->
                                    <div>
                                        <label for="speechConfidenceThreshold" class="form-label">Speech Recognition Sensitivity</label>
                                        <input type="range" id="speechConfidenceThreshold" name="speechConfidenceThreshold" 
                                               class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer" 
                                               value="0.4" min="0.1" max="0.9" step="0.1">
                                        <div class="flex justify-between text-xs text-gray-500 mt-1">
                                            <span>Low (0.1)</span>
                                            <span id="speechConfidenceValue">0.4</span>
                                            <span>High (0.9)</span>
                                        </div>
                                        <p class="text-xs text-gray-500 mt-1">Lower = more sensitive, Higher = more accurate</p>
                                    </div>

                                    <!-- Fuzzy Match Threshold -->
                                    <div>
                                        <label for="fuzzyMatchThreshold" class="form-label">Q&A Matching Sensitivity</label>
                                        <input type="range" id="fuzzyMatchThreshold" name="fuzzyMatchThreshold" 
                                               class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer" 
                                               value="0.3" min="0.1" max="0.8" step="0.1">
                                        <div class="flex justify-between text-xs text-gray-500 mt-1">
                                            <span>Strict (0.1)</span>
                                            <span id="fuzzyThresholdValue">0.3</span>
                                            <span>Flexible (0.8)</span>
                                        </div>
                                        <p class="text-xs text-gray-500 mt-1">How closely caller words must match Q&A keywords</p>
                                    </div>

                                    <!-- Max Repeats -->
                                    <div>
                                        <label for="maxRepeats" class="form-label">Max Retry Attempts</label>
                                        <select id="maxRepeats" name="maxRepeats" class="form-select">
                                            <option value="1">1 time</option>
                                            <option value="2">2 times</option>
                                            <option value="3" selected>3 times</option>
                                            <option value="4">4 times</option>
                                            <option value="5">5 times</option>
                                        </select>
                                        <p class="text-xs text-gray-500 mt-1">Times to retry before escalating unclear speech</p>
                                    </div>

                                    <!-- TTS Provider -->
                                    <div>
                                        <label for="ttsProvider" class="form-label">TTS Provider</label>
                                        <select id="ttsProvider" name="ttsProvider" class="form-select">
                                            <option value="elevenlabs" selected>ElevenLabs (Premium)</option>
                                        </select>
                                        <p class="text-xs text-gray-500 mt-1">Voice synthesis provider for agent responses</p>
                                    </div>
                                </div>

                                <div class="border-t border-gray-200 pt-6">
                                    <button type="submit" class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-6 rounded-lg shadow-md transition duration-150 ease-in-out">
                                        <i class="fas fa-save mr-2"></i>Save Performance Settings
                                    </button>
                                </div>
                            </form>
                        </section>
                    </div>

                    <div id="personality-responses-content" class="tab-content-item hidden">
                        <section class="profile-section bg-transparent shadow-none p-0">
                            <h2 class="profile-section-title"><i class="fas fa-comment-dots mr-2 text-indigo-600"></i>Agent Personality Responses</h2>
                            <form id="personality-responses-form">
                                <div id="personality-responses-list" class="space-y-4"></div>
                                <div class="mt-8 pt-5 border-t border-gray-200">
                                    <button type="submit" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-6 rounded-lg shadow-md transition duration-150 ease-in-out">
                                        <i class="fas fa-save mr-2"></i>Save Responses
                                    </button>
                                </div>
                            </form>
                        </section>
                    </div>

                    <div id="agent-setup-content" class="tab-content-item hidden">
                        <div class="bg-white py-6 md:py-8 rounded-xl"> 
                            <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center px-6 md:px-8"> 
                                <i class="fas fa-user-cog mr-3 text-indigo-600 text-2xl"></i>AI Agent Detailed Configuration
                            </h2>
                            <div id="agent-setup-form" class="space-y-0">
                                <div class="px-6 md:px-8 mb-6"> 
                                    <div class="p-4 border border-indigo-200 rounded-xl bg-indigo-50 shadow-sm">
                                        <label for="agentModeSelect" class="form-label text-base font-semibold text-indigo-800">Agent Operating Mode</label>
                                        <p class="text-xs text-indigo-700 mb-2">Choose how the AI agent should primarily function.</p>
                                        <select id="agentModeSelect" name="agentMode" class="form-select">
                                            <option value="full">Full Knowledge & Booking Agent</option>
                                            <option value="receptionist">Simple Receptionist (Greet & Route Calls Only)</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="px-6 md:px-8"> 
                                    <div class="agent-setup-section-container" data-section-type="full" data-section-name="categories">
                                        <h3 class="agent-setup-section-header">
                                            <span><i class="fas fa-list mr-2"></i>Business Categories</span>
                                            <i class="fas fa-chevron-up transition-transform duration-200"></i>
                                        </h3>
                                        <div class="section-content">
                                            <label class="form-label mb-1">Category Selection</label>
                                            <p class="text-xs text-gray-500 mb-3">Select one or more categories this company operates in.</p>
                                            <div id="agentSetupCategoriesContainer" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3 max-h-48 overflow-y-auto border border-gray-200 rounded-xl p-4 bg-white">
                                                <p class="text-gray-500 italic" id="categories-loading">Loading categories...</p>
                                            </div>
                                            <div class="mt-3">
                                                <label class="form-label mb-1">Selected Categories:</label>
                                                <ul id="selectedCategoriesList" class="list-disc list-inside text-sm text-gray-800 space-y-1 pl-1">
                                                    <li class="text-gray-500 italic">No categories selected yet.</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="agent-setup-section-container" data-section-type="full" data-section-name="specialties">
                                        <h3 class="agent-setup-section-header">
                                            <span><i class="fas fa-star mr-2"></i>Company Specialties</span>
                                            <i class="fas fa-chevron-down transition-transform duration-200"></i>
                                        </h3>
                                        <div class="section-content collapsed">
                                            <label for="companySpecialties" class="form-label">Specialties (comma-separated)</label>
                                            <input type="text" id="companySpecialties" name="companySpecialties" class="form-input wider-textbox" placeholder="e.g., Emergency HVAC repairs, eco-friendly plumbing solutions">
                                        </div>
                                    </div>
                                    <div class="agent-setup-section-container" data-section-type="full" data-section-name="company-qna">
                                        <h3 class="agent-setup-section-header">
                                            <span><i class="fas fa-question-circle mr-2"></i>Company Q&amp;A</span>
                                            <i class="fas fa-chevron-down transition-transform duration-200"></i>
                                        </h3>
                                        <div class="section-content collapsed">
                                            <p class="text-xs text-gray-500 mb-3">Add company-specific questions and answers.</p>
                                            <form id="companyQnaForm" class="space-y-3 mb-4">
                                                <input type="hidden" id="editingQnaId">
                                                <div>
                                                    <label for="companyQnaQuestion" class="form-label">Question</label>
                                                    <textarea id="companyQnaQuestion" class="form-textarea wider-textbox" rows="2" required></textarea>
                                                </div>
                                                <div>
                                                    <label for="companyQnaAnswer" class="form-label">Answer</label>
                                                    <div class="flex items-center gap-2 mb-1">
                                                        <select id="placeholderSelect" class="form-select text-xs flex-none"></select>
                                                        <button type="button" id="insertPlaceholderBtn" class="text-blue-600 text-xs">Insert</button>
                                                    </div>
                                                    <textarea id="companyQnaAnswer" class="form-textarea wider-textbox" rows="4" required></textarea>
                                                    <p id="companyQnaPreview" class="text-xs text-gray-600 mt-1"></p>
                                                </div>
                                                <div>
                                                    <label for="companyQnaKeywords" class="form-label">Keywords</label>
                                                    <input type="text" id="companyQnaKeywords" class="form-input wider-textbox" placeholder="Comma-separated keywords (e.g. thermostat, reset)">
                                                </div>
                                                <div class="flex gap-2 justify-end">
                                                    <button type="submit" id="companyQnaSaveBtn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded transition">Add</button>
                                                    <button type="button" id="companyQnaCancelBtn" class="form-button-agent-setup remove-button-agent-setup hidden">Cancel</button>
                                                </div>
                                                <p id="companyQnaFormError" class="text-red-600 text-sm hidden"></p>
                                            </form>
                                            <div id="companyQnaList" class="space-y-3"></div>
                                        </div>
                                    </div>

                                    <!-- Agent Learning & Knowledge Management Section -->
                                    <div class="agent-setup-section-container" data-section-type="full" data-section-name="learning-management">
                                        <h3 class="agent-setup-section-header">
                                            <span><i class="fas fa-brain mr-2"></i>Agent Learning & Knowledge Management</span>
                                            <i class="fas fa-chevron-down transition-transform duration-200"></i>
                                        </h3>
                                        <div class="section-content collapsed">
                                            <p class="text-xs text-gray-500 mb-4">Review AI-generated suggestions from call conversations and approve them to enhance the agent's knowledge base.</p>
                                            
                                            <!-- Learning Analytics Dashboard -->
                                            <div class="mb-6">
                                                <h4 class="text-sm font-semibold text-gray-700 mb-3">Learning Analytics</h4>
                                                <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                                                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-3">
                                                        <div class="text-lg font-bold text-blue-800" id="pending-suggestions-count">0</div>
                                                        <div class="text-xs text-blue-600">Pending Suggestions</div>
                                                    </div>
                                                    <div class="bg-green-50 border border-green-200 rounded-lg p-3">
                                                        <div class="text-lg font-bold text-green-800" id="approved-knowledge-count">0</div>
                                                        <div class="text-xs text-green-600">Approved Knowledge</div>
                                                    </div>
                                                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3">
                                                        <div class="text-lg font-bold text-yellow-800" id="weekly-learning-count">0</div>
                                                        <div class="text-xs text-yellow-600">Weekly Learning</div>
                                                    </div>
                                                    <div class="bg-purple-50 border border-purple-200 rounded-lg p-3">
                                                        <div class="text-lg font-bold text-purple-800" id="learning-score">0%</div>
                                                        <div class="text-xs text-purple-600">Learning Score</div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Pending Suggestions -->
                                            <div class="mb-6">
                                                <div class="flex justify-between items-center mb-3">
                                                    <h4 class="text-sm font-semibold text-gray-700">Pending Suggestions</h4>
                                                    <button type="button" id="bulk-approve-btn" class="text-xs bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded transition disabled:opacity-50" disabled>
                                                        Bulk Approve All
                                                    </button>
                                                </div>
                                                <div id="pending-suggestions-list" class="space-y-2 max-h-60 overflow-y-auto border border-gray-200 rounded-lg">
                                                    <div class="p-4 text-center text-gray-500">
                                                        <i class="fas fa-brain text-2xl mb-2"></i>
                                                        <p>No pending suggestions yet. The AI will learn from calls and suggest new knowledge entries.</p>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Approved Knowledge Base -->
                                            <div class="mb-6">
                                                <div class="flex justify-between items-center mb-3">
                                                    <h4 class="text-sm font-semibold text-gray-700">Approved Knowledge Base</h4>
                                                    <div class="flex gap-2">
                                                        <input type="text" id="knowledge-search" placeholder="Search knowledge..." class="text-xs px-2 py-1 border border-gray-300 rounded">
                                                        <button type="button" id="refresh-knowledge-btn" class="text-xs bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded transition">
                                                            <i class="fas fa-sync-alt"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                                <div id="approved-knowledge-list" class="space-y-2 max-h-60 overflow-y-auto border border-gray-200 rounded-lg">
                                                    <div class="p-4 text-center text-gray-500">
                                                        <i class="fas fa-database text-2xl mb-2"></i>
                                                        <p>No approved knowledge entries yet.</p>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Learning Settings -->
                                            <div class="mb-4">
                                                <h4 class="text-sm font-semibold text-gray-700 mb-3">Learning Settings</h4>
                                                <div class="space-y-3">
                                                    <label class="flex items-center">
                                                        <input type="checkbox" id="auto-approve-high-confidence" class="form-checkbox">
                                                        <span class="form-check-label">Auto-approve high confidence responses (90%+ confidence)</span>
                                                    </label>
                                                    <label class="flex items-center">
                                                        <input type="checkbox" id="daily-learning-summary" class="form-checkbox">
                                                        <span class="form-check-label">Send daily learning summary emails</span>
                                                    </label>
                                                    <div>
                                                        <label class="form-label text-xs">Learning Categories Priority</label>
                                                        <div id="learning-categories" class="flex flex-wrap gap-1 mt-1">
                                                            <span class="px-2 py-1 text-xs bg-gray-100 rounded">Customer Service</span>
                                                            <span class="px-2 py-1 text-xs bg-gray-100 rounded">Technical Support</span>
                                                            <span class="px-2 py-1 text-xs bg-gray-100 rounded">Scheduling</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="agent-setup-section-container" data-section-type="full" data-section-name="placeholders">
                                        <h3 class="agent-setup-section-header">
                                            <span><i class="fas fa-code mr-2"></i>Placeholders</span>
                                            <i class="fas fa-chevron-down transition-transform duration-200"></i>
                                        </h3>
                                        <div class="section-content collapsed space-y-2">
                                            <p class="text-xs text-gray-500">Define tokens you can use in responses.</p>
                                            <div id="placeholders-list" class="space-y-2"></div>
                                            <button type="button" id="add-placeholder-btn" class="form-button-agent-setup text-xs">Add Placeholder</button>
                                        </div>
                                    </div>
                                    <div class="agent-setup-section-container" data-section-type="full receptionist" data-section-name="time-zone">
                                        <h3 class="agent-setup-section-header">
                                            <span><i class="fas fa-clock mr-2"></i>Time Settings</span>
                                            <i class="fas fa-chevron-down transition-transform duration-200"></i>
                                        </h3>
                                        <div class="section-content collapsed">
                                            <label for="agentSetupTimezoneSelect" class="form-label">Company Time Zone (for Agent)</label>
                                            <select id="agentSetupTimezoneSelect" name="agentSetupTimezone" class="form-select"></select>
                                            <p id="agentSetupCurrentTimeDisplay" class="text-sm text-indigo-700 font-semibold mt-2 p-2 bg-indigo-50 rounded-md">Loading current time...</p>
                                        </div>
                                    </div>
                                    <div class="agent-setup-section-container" data-section-type="full receptionist" data-section-name="operating-hours">
                                        <h3 class="agent-setup-section-header">
                                            <span><i class="fas fa-calendar mr-2"></i>Operating Hours</span>
                                            <i class="fas fa-chevron-down transition-transform duration-200"></i>
                                        </h3>
                                        <div class="section-content collapsed">
                                            <div class="flex items-center justify-between mb-4">
                                                <label class="form-label">Company Operating Hours</label>
                                                <label class="flex items-center cursor-pointer">
                                                    <span class="text-sm text-gray-600 mr-2">
                                                        Use 24/7 Routing
                                                        <i class="fas fa-info-circle ml-1 text-gray-500" title="When checked, ignores the schedule and routes calls 24/7 using Call Routing Options."></i>
                                                    </span>
                                                    <input type="checkbox" id="toggle24Hours" name="use247Routing" class="form-checkbox">
                                                </label>
                                            </div>
                                            <p class="text-xs text-gray-500 mb-4">These are the hours when the company is open. Times are based on the Company Time Zone selected above.</p>
                                            <div id="operating-hours-list" class="space-y-3">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="agent-setup-section-container" data-section-type="full receptionist" data-section-name="agent-script">
                                        <h3 class="agent-setup-section-header">
                                            <span><i class="fas fa-comment-dots mr-2"></i>Agent Core Scripting</span>
                                            <i class="fas fa-chevron-down transition-transform duration-200"></i>
                                        </h3>
                                        <div class="section-content collapsed space-y-4">
                                            <div>
                                                <label class="form-label">Greeting Type</label>
                                                <div class="flex items-center space-x-4">
                                                    <label class="flex items-center"><input type="radio" name="greetingType" id="greetingTypeTTS" value="tts" class="form-radio" checked><span class="ml-1">Text-to-Speech</span></label>
                                                    <label class="flex items-center"><input type="radio" name="greetingType" id="greetingTypeAudio" value="audio" class="form-radio"><span class="ml-1">Audio File</span></label>
                                                </div>
                                            </div>
                                            <div id="greetingAudioUploadContainer" class="hidden">
                                                <label for="greetingAudioFile" class="form-label">Greeting Audio (MP3)</label>
                                                <input type="file" id="greetingAudioFile" accept="audio/mpeg" class="form-input">
                                                <audio id="greetingAudioPreview" controls class="mt-2 hidden"></audio>
                                            </div>
                                            <div id="greetingTextContainer">
                                                <label for="agentGreeting" class="form-label">Agent Greeting</label>
                                                <textarea id="agentGreeting" name="agentGreeting" rows="3" class="form-textarea wider-textbox" placeholder="e.g., Thank you for calling {CompanyName}, this is {AgentName}, how can I help you today?"></textarea>
                                            </div>
                                            <div data-section-type="full"> 
                                                <label for="mainAgentScript" class="form-label">Main Conversational Script / Knowledge</label>
                                                <p class="text-xs text-gray-500 mb-2">Define the AI agent's structured conversational script. The agent will follow this script for call flow, greetings, booking procedures, and responses. Use sections like "Greeting:", "Service Booking:", "Transfer Handling:", etc.</p>
                                                <textarea id="mainAgentScript" name="mainAgentScript" rows="15" class="form-textarea wider-textbox" placeholder="Example structure:&#10;&#10;Greeting & Identification:&#10;Agent: Hi, {CompanyName}! How can I help you today?&#10;&#10;Service Booking:&#10;Agent: Of course! I can help you schedule an appointment. May I have your full name and the best phone number to reach you?&#10;Agent: What service do you need? (Options: AC repair, maintenance, duct cleaning, estimate)&#10;Agent: Which days and times work best for you? We offer morning (8-10, 10-12) and afternoon (12-2, 2-4) slots.&#10;&#10;Transfer Handling:&#10;Agent: I can take a message and have a technician call you back as soon as possible. May I have your name and phone number?&#10;&#10;Information Responses:&#10;Do you offer emergency service? Yes, we offer 24/7 emergency AC repair.&#10;What areas do you serve? We serve all of [County/City] including [specific areas].&#10;Are you licensed and insured? Yes, we are fully licensed, bonded, and insured.&#10;&#10;Closing:&#10;Agent: Thank you for calling {CompanyName}. Have a great day!"></textarea>
                                            </div>
                                            <div>
                                                <label for="categoryQAs" class="form-label">Category-Specific Q&As</label>
                                                <p class="text-xs text-gray-500 mb-2">Q&As for selected business categories, used by the AI agent to answer common questions.</p>
                                                <textarea id="categoryQAs" name="categoryQAs" rows="8" class="form-textarea wider-textbox" readonly placeholder="Q&As will appear here based on selected categories..."></textarea>
                                            </div>
                                            <div>
                                                <label for="agentClosing" class="form-label">Agent Closing</label>
                                                <textarea id="agentClosing" name="agentClosing" rows="3" class="form-textarea wider-textbox" placeholder="e.g., Thank you for calling! Have a great day!"></textarea>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="agent-setup-section-container" data-section-type="full" data-section-name="protocols">
                                        <h3 class="agent-setup-section-header">
                                            <span><i class="fas fa-book mr-2"></i>Specific Scenario Protocols</span>
                                            <i class="fas fa-chevron-down transition-transform duration-200"></i>
                                        </h3>
                                        <div class="section-content collapsed space-y-4">
                                            <div>
                                                <button type="button" data-protocol-target="system-delay-protocol" class="protocol-toggle flex items-center w-full text-left text-sm font-medium text-gray-700 mb-1 hover:text-indigo-600 transition-colors duration-200">
                                                    <i class="fas fa-chevron-right mr-2 text-xs transition-transform duration-200"></i>System Delay/Reboot Protocol
                                                </button>
                                                <div id="system-delay-protocol" class="protocol-section collapsed pl-5">
                                                    <textarea name="protocolSystemDelay" rows="5" class="form-textarea wider-textbox" placeholder="Default system delay protocol..."></textarea>
                                                </div>
                                            </div>
                                            <div>
                                                <button type="button" data-protocol-target="message-taking-protocol" class="protocol-toggle flex items-center w-full text-left text-sm font-medium text-gray-700 mb-1 hover:text-indigo-600 transition-colors duration-200">
                                                     <i class="fas fa-chevron-right mr-2 text-xs transition-transform duration-200"></i>Message Taking Protocol</button>
                                                <div id="message-taking-protocol" class="protocol-section collapsed pl-5">
                                                    <textarea name="protocolMessageTaking" rows="5" class="form-textarea wider-textbox" placeholder="Default message taking protocol..."></textarea>
                                                </div>
                                            </div>
                                            <div>
                                                <button type="button" data-protocol-target="caller-reconnect-protocol" class="protocol-toggle flex items-center w-full text-left text-sm font-medium text-gray-700 mb-1 hover:text-indigo-600 transition-colors duration-200">
                                                    <i class="fas fa-chevron-right mr-2 text-xs transition-transform duration-200"></i>Caller Reconnect – Apology Protocol</button>
                                                <div id="caller-reconnect-protocol" class="protocol-section collapsed pl-5">
                                                     <textarea name="protocolCallerReconnect" rows="3" class="form-textarea wider-textbox"></textarea>
                                                </div>
                                            </div>
                                            <div>
                                                <button type="button" data-protocol-target="when-in-doubt-protocol" class="protocol-toggle flex items-center w-full text-left text-sm font-medium text-gray-700 mb-1 hover:text-indigo-600 transition-colors duration-200">
                                                    <i class="fas fa-chevron-right mr-2 text-xs transition-transform duration-200"></i>When in Doubt (General Escalation)</button>
                                                <div id="when-in-doubt-protocol" class="protocol-section collapsed pl-5">
                                                    <textarea name="protocolWhenInDoubt" rows="4" class="form-textarea wider-textbox"></textarea>
                                                </div>
                                            </div>
                                            <div>
                                                <button type="button" data-protocol-target="caller-frustration-protocol" class="protocol-toggle flex items-center w-full text-left text-sm font-medium text-gray-700 mb-1 hover:text-indigo-600 transition-colors duration-200">
                                                    <i class="fas fa-chevron-right mr-2 text-xs transition-transform duration-200"></i>Caller Frustration / "Are You a Robot?"</button>
                                                <div id="caller-frustration-protocol" class="protocol-section collapsed pl-5">
                                                    <textarea name="protocolCallerFrustration" rows="4" class="form-textarea wider-textbox"></textarea>
                                                </div>
                                            </div>
                                            <div>
                                                <button type="button" data-protocol-target="telemarketer-filter-protocol" class="protocol-toggle flex items-center w-full text-left text-sm font-medium text-gray-700 mb-1 hover:text-indigo-600 transition-colors duration-200">
                                                    <i class="fas fa-chevron-right mr-2 text-xs transition-transform duration-200"></i>Telemarketer Filter</button>
                                                <div id="telemarketer-filter-protocol" class="protocol-section collapsed pl-5">
                                                    <textarea name="protocolTelemarketerFilter" rows="4" class="form-textarea wider-textbox"></textarea>
                                                </div>
                                            </div>
                                            <div>
                                                <button type="button" data-protocol-target="behavior-guidelines-protocol" class="protocol-toggle flex items-center w-full text-left text-sm font-medium text-gray-700 mb-1 hover:text-indigo-600 transition-colors duration-200">
                                                    <i class="fas fa-chevron-right mr-2 text-xs transition-transform duration-200"></i>Behavior Guidelines</button>
                                                <div id="behavior-guidelines-protocol" class="protocol-section collapsed pl-5">
                                                    <textarea name="protocolBehaviorGuidelines" rows="5" class="form-textarea wider-textbox"></textarea>
                                                </div>
                                            </div>
                                            <div>
                                                <button type="button" data-protocol-target="booking-confirmation-protocol" class="protocol-toggle flex items-center w-full text-left text-sm font-medium text-gray-700 mb-1 hover:text-indigo-600 transition-colors duration-200">
                                                    <i class="fas fa-chevron-right mr-2 text-xs transition-transform duration-200"></i>Booking Confirmation Script</button>
                                                <div id="booking-confirmation-protocol" class="protocol-section collapsed pl-5">
                                                    <textarea name="protocolBookingConfirmation" rows="3" class="form-textarea wider-textbox"></textarea>
                                                </div>
                                            </div>
                                            <div>
                                                <button type="button" data-protocol-target="text-to-pay-protocol" class="protocol-toggle flex items-center w-full text-left text-sm font-medium text-gray-700 mb-1 hover:text-indigo-600 transition-colors duration-200">
                                                    <i class="fas fa-chevron-right mr-2 text-xs transition-transform duration-200"></i>Text-to-Pay Request Script</button>
                                                <div id="text-to-pay-protocol" class="protocol-section collapsed pl-5">
                                                    <textarea name="protocolTextToPay" rows="3" class="form-textarea wider-textbox"></textarea>
                                                    <div class="mt-2">
                                                        <label class="form-label mb-1">Phone Number Source for Text-to-Pay</label>
                                                        <select name="textToPayPhoneSource" class="form-select sm:w-auto">
                                                            <option value="callerID">Use caller ID if confirmed</option>
                                                            <option value="askCustomer">Ask customer to provide number</option>
                                                            <option value="both">Ask to confirm caller ID or provide new number</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="agent-setup-section-container" data-section-type="full" data-section-name="scheduling-rules">
                                        <h3 class="agent-setup-section-header">
                                            <span><i class="fas fa-calendar-check mr-2"></i>Service Scheduling Rules</span>
                                            <i class="fas fa-chevron-down transition-transform duration-200"></i>
                                        </h3>
                                        <div class="section-content collapsed">
                                            <p class="text-xs text-gray-500 mb-3">Define how the AI determines appointment availability for different services.</p>
                                            <div id="serviceSchedulingRulesContainer" class="space-y-6"></div>
                                            <button type="button" id="add-new-scheduling-rule-btn" class="form-button-agent-setup mt-6 flex items-center">
                                                <i class="fas fa-plus mr-2"></i>Add Scheduling Rule
                                            </button>
                                            <div id="scheduling-interpreter-container" class="mt-6 p-4 border border-blue-300 bg-blue-50 rounded-lg shadow">
                                                <h5 class="text-md font-semibold text-blue-700 mb-2">Live Scheduling Helper</h5>
                                                <div id="current-time-display" class="text-sm text-blue-600 mb-3">
                                                    Current Time: <span class="font-medium">Loading...</span>
                                                </div>
                                                <div id="scheduling-interpreter-output" class="text-sm text-gray-700 space-y-1">
                                                    <p class="italic">Configure or add a scheduling rule above to see its live interpretation here.</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="agent-setup-section-container" data-section-type="full receptionist" data-section-name="routing-notifications">
                                        <h3 class="agent-setup-section-header">
                                            <span><i class="fas fa-route mr-2"></i>Call Routing & Notifications</span>
                                            <i class="fas fa-chevron-down transition-transform duration-200"></i>
                                        </h3>
                                        <div class="section-content collapsed space-y-6">
                                             <div>
                                                <label class="form-label mb-1">General Call Routing (During Business Hours)</label>
                                                <p class="text-xs text-gray-500 mb-2">Define primary numbers for AI transfers.</p>
                                                <div id="call-routing-list" class="space-y-3"></div>
                                                <button type="button" id="add-call-routing-option" class="form-button-agent-setup mt-2 text-xs">Add Routing Option</button>
                                            </div>
                                            <div>
                                                <label class="form-label mb-1">After-Hours Call Routing</label>
                                                <p class="text-xs text-gray-500 mb-2">If "After-Hours Protocol" in Business Hours is set to forward.</p>
                                                <div id="after-hours-routing-list" class="space-y-3"></div>
                                                <button type="button" id="add-after-hours-routing-option" class="form-button-agent-setup mt-2 text-xs">Add After-Hours Option</button>
                                            </div>
                                            <div>
                                                <label class="form-label mb-1">Call Summary Notification Recipients</label>
                                                <p class="text-xs text-gray-500 mb-2">Who gets call summaries via text/email.</p>
                                                <div id="call-summaries-list" class="space-y-3"></div>
                                                <button type="button" id="add-call-summary-recipient" class="form-button-agent-setup mt-2 text-xs">Add Recipient</button>
                                            </div>
                                            <div>
                                                <label class="form-label mb-1">After-Hours Notification Recipients</label>
                                                <p class="text-xs text-gray-500 mb-2">Who gets notified of after-hours calls/messages.</p>
                                                <div id="after-hours-notifications-list" class="space-y-3"></div>
                                                <button type="button" id="add-after-hours-notification-recipient" class="form-button-agent-setup mt-2 text-xs">Add Recipient</button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="agent-setup-section-container" data-section-type="full receptionist" data-section-name="malfunction-handling">
                                        <h3 class="agent-setup-section-header">
                                            <span><i class="fas fa-exclamation-triangle mr-2"></i>AI Malfunction Handling</span>
                                            <i class="fas fa-chevron-down transition-transform duration-200"></i>
                                        </h3>
                                        <div class="section-content collapsed space-y-6">
                                             <div>
                                                <label class="form-label mb-1">Call Forwarding on Malfunction</label>
                                                <p class="text-xs text-gray-500 mb-2">Forward calls if AI skips or drops. Add multiple for round-robin or failover.</p>
                                                <div id="malfunction-forwarding-list" class="space-y-3"></div>
                                                <button type="button" id="add-malfunction-forwarding-number" class="form-button-agent-setup mt-2 text-xs">Add Forwarding Number</button>
                                            </div>
                                            <div>
                                                <label class="form-label mb-1">Text Notifications on Malfunction</label>
                                                <p class="text-xs text-gray-500 mb-2">Send SMS alerts when calls are forwarded due to malfunction.</p>
                                                <div id="malfunction-notifications-list" class="space-y-3"></div>
                                                <button type="button" id="add-malfunction-notification-recipient" class="form-button-agent-setup mt-2 text-xs">Add Notification Recipient</button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="mt-10 pt-6 border-t border-gray-300 flex justify-end">
                                        <button type="submit" id="save-agent-setup-button" class="form-button-agent-setup text-base py-3 px-6 inline-flex items-center">
                                            <i class="fas fa-save mr-2"></i>Save Agent Setup
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="ai-agent-setup-content" class="tab-content-item hidden">
                        <div class="bg-white py-6 md:py-8 rounded-xl">
                            <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center px-6 md:px-8">
                                <i class="fas fa-robot mr-3 text-indigo-600 text-2xl"></i>AI Agent Setup
                                <span class="ml-3 text-sm bg-green-100 text-green-800 px-3 py-1 rounded-full">HighLevel Competitive Mode</span>
                            </h2>

                            <!-- Quick Setup Section -->
                            <div class="px-6 md:px-8 mb-8">
                                <div class="bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6 shadow-sm">
                                    <h3 class="text-lg font-semibold text-blue-900 mb-4 flex items-center">
                                        <i class="fas fa-rocket mr-2"></i>Quick Setup (Recommended)
                                    </h3>
                                    <p class="text-blue-700 mb-6">Get your AI agent running in under 5 minutes with proven templates. You can customize later.</p>
                                    
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                        <!-- Business Type Templates -->
                                        <div>
                                            <label class="form-label text-blue-900">Choose Your Business Type</label>
                                            <select id="aiBusinessTypeTemplate" class="form-select">
                                                <option value="">Select a template...</option>
                                                <option value="restaurant">Restaurant & Food Service</option>
                                                <option value="hvac">HVAC & Air Conditioning</option>
                                                <option value="plumbing">Plumbing Services</option>
                                                <option value="automotive">Auto Repair & Service</option>
                                                <option value="medical">Medical & Healthcare</option>
                                                <option value="legal">Legal Services</option>
                                                <option value="beauty">Beauty & Wellness</option>
                                                <option value="cleaning">Cleaning Services</option>
                                                <option value="real-estate">Real Estate</option>
                                                <option value="retail">Retail & E-commerce</option>
                                                <option value="professional">Professional Services</option>
                                                <option value="custom">Custom Setup</option>
                                            </select>
                                        </div>

                                        <!-- Agent Persona -->
                                        <div>
                                            <label class="form-label text-blue-900">Agent Personality</label>
                                            <select id="aiAgentPersona" class="form-select">
                                                <option value="professional">Professional & Courteous</option>
                                                <option value="friendly">Friendly & Conversational</option>
                                                <option value="sales">Sales-Focused & Persuasive</option>
                                                <option value="casual">Casual & Relaxed</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="flex gap-4">
                                        <button id="quickSetupDeployBtn" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg shadow-md transition duration-150 ease-in-out flex items-center">
                                            <i class="fas fa-magic mr-2"></i>Deploy AI Agent (1-Click)
                                        </button>
                                        <button id="customSetupBtn" class="bg-gray-600 hover:bg-gray-700 text-white font-semibold py-3 px-6 rounded-lg shadow-md transition duration-150 ease-in-out flex items-center">
                                            <i class="fas fa-cogs mr-2"></i>Custom Configuration
                                        </button>
                                    </div>

                                    <!-- Template Preview -->
                                    <div id="templatePreview" class="mt-6 p-4 bg-white border border-blue-200 rounded-lg hidden">
                                        <h4 class="font-semibold text-gray-900 mb-2">Template Preview:</h4>
                                        <div id="templatePreviewContent" class="text-sm text-gray-700"></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Configuration Tabs -->
                            <div id="aiAgentConfigTabs" class="px-6 md:px-8">
                                <div class="border-b border-gray-200 mb-6">
                                    <nav class="-mb-px flex space-x-8 overflow-x-auto">
                                        <button class="ai-config-tab-btn py-2 px-1 border-b-2 font-medium text-sm border-indigo-500 text-indigo-600 whitespace-nowrap" data-tab="agent-details">
                                            <i class="fas fa-user-cog mr-1"></i>Agent Details
                                        </button>
                                        <button class="ai-config-tab-btn py-2 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap" data-tab="agent-goals">
                                            <i class="fas fa-bullseye mr-1"></i>Agent Goals
                                        </button>
                                        <button class="ai-config-tab-btn py-2 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap" data-tab="phone-availability">
                                            <i class="fas fa-phone-alt mr-1"></i>Phone & Availability
                                        </button>
                                        <button class="ai-config-tab-btn py-2 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap" data-tab="dashboard-logs">
                                            <i class="fas fa-chart-line mr-1"></i>Dashboard & Logs
                                        </button>
                                        <button class="ai-config-tab-btn py-2 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap" data-tab="scheduling">
                                            <i class="fas fa-calendar-check mr-1"></i>Smart Scheduling
                                        </button>
                                        <button class="ai-config-tab-btn py-2 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap" data-tab="knowledge">
                                            <i class="fas fa-brain mr-1"></i>Knowledge Base
                                        </button>
                                        <button class="ai-config-tab-btn py-2 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap" data-tab="intelligence">
                                            <i class="fas fa-robot mr-1"></i>AI Intelligence
                                        </button>
                                        <button class="ai-config-tab-btn py-2 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap" data-tab="workflows">
                                            <i class="fas fa-flow-chart mr-1"></i>Call Workflows
                                        </button>
                                        <button class="ai-config-tab-btn py-2 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap" data-tab="analytics">
                                            <i class="fas fa-chart-bar mr-1"></i>Analytics
                                        </button>
                                    </nav>
                                </div>

                                <!-- Agent Details Tab -->
                                <div id="ai-agent-details-tab" class="ai-config-tab-content">
                                    <div class="space-y-6">
                                        <!-- Basic Agent Information -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-user-circle mr-2 text-indigo-600"></i>Agent Information
                                            </h4>
                                            
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                <!-- Agent Name -->
                                                <div>
                                                    <label class="form-label">Agent name <span class="text-red-500">*</span></label>
                                                    <input type="text" id="agentName" name="agentName" value="Jessica" maxlength="40" class="form-input" placeholder="Enter the name of the Agent">
                                                    <p class="text-xs text-gray-500 mt-1"><span id="agentNameCount">7</span> / 40</p>
                                                </div>

                                                <!-- Business Name -->
                                                <div>
                                                    <label class="form-label">Business name <span class="text-red-500">*</span></label>
                                                    <input type="text" id="businessName" name="businessName" value="Penguin Air Cooling & Heating, Corp." class="form-input" placeholder="Enter the name of the Business">
                                                </div>

                                                <!-- Language -->
                                                <div>
                                                    <label class="form-label">Language</label>
                                                    <select id="agentLanguage" name="agentLanguage" class="form-select">
                                                        <option value="english" selected>English</option>
                                                        <option value="spanish">Spanish</option>
                                                        <option value="french">French</option>
                                                        <option value="german">German</option>
                                                        <option value="italian">Italian</option>
                                                        <option value="portuguese">Portuguese</option>
                                                    </select>
                                                    <p class="text-xs text-gray-500 mt-1">Choose a Language for the Agent</p>
                                                </div>

                                                <!-- Voice -->
                                                <div>
                                                    <label class="form-label">Voice</label>
                                                    <div class="flex gap-2">
                                                        <select id="agentVoice" name="agentVoice" class="form-select flex-1">
                                                            <option value="bria" selected>Bria</option>
                                                            <option value="jessica">Jessica</option>
                                                            <option value="sarah">Sarah</option>
                                                            <option value="michael">Michael</option>
                                                            <option value="david">David</option>
                                                            <option value="emma">Emma</option>
                                                        </select>
                                                        <button type="button" id="playVoiceBtn" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg flex items-center">
                                                            <i class="fas fa-play mr-1"></i>Play
                                                        </button>
                                                    </div>
                                                    <p class="text-xs text-gray-500 mt-1">Try different voices for your AI agent</p>
                                                </div>

                                                <!-- Timezone -->
                                                <div>
                                                    <label class="form-label">Timezone <span class="text-red-500">*</span></label>
                                                    <select id="agentTimezone" name="agentTimezone" class="form-select">
                                                        <option value="GMT-04:00 America/New_York (EDT)" selected>GMT-04:00 America/New_York (EDT)</option>
                                                        <option value="GMT-05:00 America/Chicago (CDT)">GMT-05:00 America/Chicago (CDT)</option>
                                                        <option value="GMT-06:00 America/Denver (MDT)">GMT-06:00 America/Denver (MDT)</option>
                                                        <option value="GMT-07:00 America/Los_Angeles (PDT)">GMT-07:00 America/Los_Angeles (PDT)</option>
                                                        <option value="GMT-08:00 America/Anchorage (AKDT)">GMT-08:00 America/Anchorage (AKDT)</option>
                                                        <option value="GMT-10:00 Pacific/Honolulu (HST)">GMT-10:00 Pacific/Honolulu (HST)</option>
                                                    </select>
                                                    <p class="text-xs text-gray-500 mt-1">Select the timezone for your AI agent</p>
                                                </div>

                                                <!-- Direction -->
                                                <div>
                                                    <label class="form-label">Direction</label>
                                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-2">
                                                        <label class="relative">
                                                            <input type="radio" name="callDirection" value="inbound" checked class="sr-only peer">
                                                            <div class="w-full p-4 border-2 border-gray-200 rounded-lg cursor-pointer peer-checked:border-indigo-500 peer-checked:bg-indigo-50 hover:bg-gray-50 transition-colors">
                                                                <div class="flex items-center">
                                                                    <i class="fas fa-phone-volume text-indigo-600 text-xl mr-3"></i>
                                                                    <div>
                                                                        <div class="font-medium text-gray-900">Inbound call</div>
                                                                        <div class="text-xs text-gray-500">The agent picks up all Incoming Calls</div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </label>
                                                        
                                                        <label class="relative opacity-50">
                                                            <input type="radio" name="callDirection" value="outbound" disabled class="sr-only peer">
                                                            <div class="w-full p-4 border-2 border-gray-200 rounded-lg cursor-not-allowed">
                                                                <div class="flex items-center">
                                                                    <i class="fas fa-phone text-gray-400 text-xl mr-3"></i>
                                                                    <div>
                                                                        <div class="font-medium text-gray-600">Outbound call</div>
                                                                        <div class="text-xs text-gray-400">The agent makes Outbound Calls</div>
                                                                        <div class="text-xs text-blue-600 mt-1">Coming Soon</div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Agent's Initial Message -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-comment-dots mr-2 text-indigo-600"></i>Agent's Initial Message <span class="text-red-500">*</span>
                                            </h4>
                                            
                                            <div class="space-y-4">
                                                <textarea id="agentInitialMessage" name="agentInitialMessage" rows="4" maxlength="190" class="form-input w-full resize-none" placeholder="Hi, Penguin Air conditioning! —how can I help you today?">Hi, Penguin Air conditioning! —how can I help you today?</textarea>
                                                <div class="flex justify-between items-center">
                                                    <p class="text-xs text-gray-500">This is the first message your AI agent will say when answering calls</p>
                                                    <p class="text-xs text-gray-500"><span id="initialMessageCount">56</span> / 190</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Agent Goals Tab -->
                                <div id="ai-agent-goals-tab" class="ai-config-tab-content hidden">
                                    <div class="space-y-6">
                                        <!-- Agent Goals Section -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <div class="flex justify-between items-start mb-6">
                                                <div>
                                                    <h4 class="text-lg font-semibold text-gray-900 flex items-center">
                                                        <i class="fas fa-bullseye mr-2 text-indigo-600"></i>Agent goals
                                                    </h4>
                                                    <p class="text-gray-600 mt-1">Set up Agent's personality and actions</p>
                                                </div>
                                                <button class="text-indigo-600 hover:text-indigo-800 text-sm">
                                                    Switch to basic mode
                                                </button>
                                            </div>

                                            <!-- Knowledge Base Selection -->
                                            <div class="mb-6">
                                                <label class="form-label">Select knowledge base</label>
                                                <div class="flex gap-2">
                                                    <select id="knowledgeBaseSelect" name="knowledgeBase" class="form-select flex-1">
                                                        <option value="">Select knowledge base for this agent</option>
                                                        <option value="penguin-air-kb">Penguin Air Knowledge Base</option>
                                                        <option value="hvac-general-kb">HVAC General Knowledge</option>
                                                        <option value="customer-service-kb">Customer Service Knowledge</option>
                                                    </select>
                                                    <button type="button" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg flex items-center whitespace-nowrap">
                                                        <i class="fas fa-plus mr-2"></i>Create New
                                                    </button>
                                                </div>
                                            </div>

                                            <!-- Behavior Guidelines (Prompt) -->
                                            <div>
                                                <div class="flex justify-between items-center mb-2">
                                                    <label class="form-label">Prompt</label>
                                                    <div class="flex items-center gap-2">
                                                        <span class="text-xs text-gray-500"><span id="promptWordCount">183</span> words left</span>
                                                        <button type="button" class="text-indigo-600 hover:text-indigo-800 text-sm">
                                                            <i class="fas fa-expand-arrows-alt mr-1"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                                
                                                <textarea id="behaviorGuidelines" name="behaviorGuidelines" rows="20" class="form-input w-full resize-none font-mono text-sm has-default-content" placeholder="Enter behavior guidelines for your AI agent...">Behavior Guidelines:
Never interrupt the caller.
Always be polite, personable, and sympathetic.
Stay relaxed, human, and steady — avoid sounding rushed or robotic.
If caller says "How are you?" → Reply: "Doing great, thanks! How can I help you?"
Always acknowledge responses right away with a short line before moving on. Use "Ok" (no "Got it!").
Never stay silent more than 2 seconds between speaking.

If Caller Says "It's a Machine" / "Are You Real" / Sounds Frustrated Protocol:
If the caller says "It's a machine," "Are you real?" or expresses frustration thinking they are speaking to a robot:
Agent Response: "Please, I am here to help you! You can speak to me naturally and ask anything you need — How can I help you?"
Continue with the normal call flow (collecting information, confirming service, booking, etc.).
If frustration persists or the agent is unsure how to proceed, follow the When in Doubt protocol (see Customer Appointment Status Inquiries – Agent Procedure).

When in Doubt (General):
If the agent detects customer frustration or is unsure how to handle any request:
Say: "Ok, to ensure you get the best help, I'm transferring you to a service advisor who can assist with your service needs. Please hold."
Transfer to Service Advisor.
If transfer fails, follow the System Delay/Reboot Protocol.

System Delay/Reboot Protocol:
If system delays for more than 2 seconds:
Say: "I'm sorry, looks like my system's moving a little slow. Thanks for your patience!"
If delay persists or system fails:
Say: "I'm so sorry — looks like my system isn't responding. Let me transfer you to a service advisor right away."
Attempt transfer to Service Advisor.
If unable to transfer after 15 seconds:
Apologize: "I'm so sorry, I'm unable to complete the transfer right now."
Confirm callback number: "May I confirm your best number so we can follow up right away?"
Close: "Thank you for your patience — we'll ensure you're contacted quickly."

Caller Reconnect – Apology Protocol:
If a caller calls back upset after disconnect:
Apologize warmly: "I'm so sorry we got disconnected. Thank you for calling back."
Ask: "Would you like me to continue helping you now, or connect you to a service advisor?"
If caller requests Service Advisor or open hours (7:00 AM–7:00 PM ET):
Say: "Ok, I'm transferring you to a service advisor. Please hold."
Transfer to Service Advisor.
If transfer fails, follow System Delay/Reboot Protocol.
If after hours (7:00 PM–7:00 AM ET):
Say: "Since it's after hours, I can schedule you now or take a message for follow-up. Which would you prefer?"
If message, follow Message Taking Protocol.

Defining the Call Type:
Step 1 - Ask: "Just so I can check the right schedule — are you calling for a repair service or a maintenance tune-up?"
Use keywords:
"No cool," "no heat," "not working," "leak," "drain," "thermostat," "hot," "water," "emergency" → Repair Service
"Tune-up," "seasonal check," "maintenance" → Maintenance Protocol

Emergency Service Calls:
If caller says "emergency":
Ask: "Would you like me to connect you with our emergency service call team right now, or help schedule the soonest available visit?"
If immediate transfer:
Confirm Emergency: Verify if immediate transfer is needed.
Check Time (ET):
7:00 AM–7:00 PM: Say: "Ok, I'm transferring you to our emergency service call team. Please hold."
Transfer to Emergency Service Call Team.
If transfer fails, follow System Delay/Reboot Protocol.
7:00 PM–7:00 AM: Say: "It's after hours. I can schedule you now or take a message for follow-up. Which would you prefer?"
If message, follow Message Taking Protocol.
If scheduling, proceed to Repair Service Call Protocol.</textarea>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Phone & Availability Tab -->
                                <div id="ai-phone-availability-tab" class="ai-config-tab-content hidden">
                                    <div class="space-y-6">
                                        <!-- Phone Configuration -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-phone-alt mr-2 text-indigo-600"></i>Phone Configuration
                                            </h4>
                                            
                                            <!-- Phone Number Selection -->
                                            <div class="mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                                                <div class="flex items-start">
                                                    <i class="fas fa-info-circle text-blue-600 mt-1 mr-2"></i>
                                                    <div>
                                                        <p class="text-sm text-blue-800 font-medium">Select from configured Twilio numbers</p>
                                                        <p class="text-xs text-blue-600 mt-1">Numbers are managed in the Configuration tab. <a href="#" onclick="switchToConfigTab()" class="underline hover:no-underline">Manage phone numbers →</a></p>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                <div>
                                                    <label class="form-label">Primary Phone Number</label>
                                                    <select id="primaryPhoneNumber" class="form-select">
                                                        <option value="">Select primary number...</option>
                                                        <!-- Options populated by JavaScript from Configuration tab -->
                                                    </select>
                                                    <p class="text-xs text-gray-500 mt-1">Main number for incoming calls</p>
                                                </div>
                                                
                                                <div>
                                                    <label class="form-label">Backup Phone Number</label>
                                                    <select id="backupPhoneNumber" class="form-select">
                                                        <option value="">Select backup number...</option>
                                                        <option value="none">No backup number</option>
                                                        <!-- Options populated by JavaScript from Configuration tab -->
                                                    </select>
                                                    <p class="text-xs text-gray-500 mt-1">Fallback number for transfers</p>
                                                </div>
                                                
                                                <div>
                                                    <label class="form-label">Maximum Concurrent Calls</label>
                                                    <select id="maxConcurrentCalls" class="form-select">
                                                        <option value="1">1 call</option>
                                                        <option value="2" selected>2 calls</option>
                                                        <option value="3">3 calls</option>
                                                        <option value="5">5 calls</option>
                                                        <option value="10">10 calls</option>
                                                    </select>
                                                </div>
                                                
                                                <div>
                                                    <label class="form-label">Call Recording</label>
                                                    <select id="callRecording" class="form-select">
                                                        <option value="enabled" selected>Enabled</option>
                                                        <option value="disabled">Disabled</option>
                                                        <option value="ask-permission">Ask Permission</option>
                                                    </select>
                                                </div>
                                            </div>
                                            
                                            <!-- Available Phone Numbers Display -->
                                            <div id="availableNumbersDisplay" class="mt-6">
                                                <h5 class="text-sm font-medium text-gray-700 mb-3">Available Configured Numbers:</h5>
                                                <div id="configuredNumbersList" class="space-y-2">
                                                    <!-- Populated by JavaScript -->
                                                    <div class="text-sm text-gray-500 italic">No phone numbers configured. Please add numbers in the Configuration tab.</div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Business Hours -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-clock mr-2 text-indigo-600"></i>Business Hours & Availability
                                            </h4>
                                            
                                            <div class="space-y-4">
                                                <!-- 24/7 Toggle -->
                                                <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                                                    <div>
                                                        <h5 class="font-medium text-gray-900">24/7 Availability</h5>
                                                        <p class="text-sm text-gray-600">Agent answers calls 24 hours a day, 7 days a week</p>
                                                    </div>
                                                    <label class="relative inline-flex items-center cursor-pointer">
                                                        <input type="checkbox" id="is24x7" class="sr-only peer">
                                                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600"></div>
                                                    </label>
                                                </div>

                                                <!-- Business Hours Grid -->
                                                <div id="businessHoursContainer" class="space-y-3">
                                                    <div class="grid grid-cols-7 gap-2 text-xs font-medium text-gray-500 mb-2">
                                                        <div>Mon</div>
                                                        <div>Tue</div>
                                                        <div>Wed</div>
                                                        <div>Thu</div>
                                                        <div>Fri</div>
                                                        <div>Sat</div>
                                                        <div>Sun</div>
                                                    </div>
                                                    <div class="grid grid-cols-7 gap-2">
                                                        <div class="space-y-2">
                                                            <input type="time" id="mon_open" value="08:00" class="form-input text-xs">
                                                            <input type="time" id="mon_close" value="17:00" class="form-input text-xs">
                                                            <label class="flex items-center text-xs">
                                                                <input type="checkbox" id="mon_closed" class="form-checkbox mr-1">Closed
                                                            </label>
                                                        </div>
                                                        <div class="space-y-2">
                                                            <input type="time" id="tue_open" value="08:00" class="form-input text-xs">
                                                            <input type="time" id="tue_close" value="17:00" class="form-input text-xs">
                                                            <label class="flex items-center text-xs">
                                                                <input type="checkbox" id="tue_closed" class="form-checkbox mr-1">Closed
                                                            </label>
                                                        </div>
                                                        <div class="space-y-2">
                                                            <input type="time" id="wed_open" value="08:00" class="form-input text-xs">
                                                            <input type="time" id="wed_close" value="17:00" class="form-input text-xs">
                                                            <label class="flex items-center text-xs">
                                                                <input type="checkbox" id="wed_closed" class="form-checkbox mr-1">Closed
                                                            </label>
                                                        </div>
                                                        <div class="space-y-2">
                                                            <input type="time" id="thu_open" value="08:00" class="form-input text-xs">
                                                            <input type="time" id="thu_close" value="17:00" class="form-input text-xs">
                                                            <label class="flex items-center text-xs">
                                                                <input type="checkbox" id="thu_closed" class="form-checkbox mr-1">Closed
                                                            </label>
                                                        </div>
                                                        <div class="space-y-2">
                                                            <input type="time" id="fri_open" value="08:00" class="form-input text-xs">
                                                            <input type="time" id="fri_close" value="17:00" class="form-input text-xs">
                                                            <label class="flex items-center text-xs">
                                                                <input type="checkbox" id="fri_closed" class="form-checkbox mr-1">Closed
                                                            </label>
                                                        </div>
                                                        <div class="space-y-2">
                                                            <input type="time" id="sat_open" value="09:00" class="form-input text-xs">
                                                            <input type="time" id="sat_close" value="15:00" class="form-input text-xs">
                                                            <label class="flex items-center text-xs">
                                                                <input type="checkbox" id="sat_closed" class="form-checkbox mr-1">Closed
                                                            </label>
                                                        </div>
                                                        <div class="space-y-2">
                                                            <input type="time" id="sun_open" value="10:00" class="form-input text-xs">
                                                            <input type="time" id="sun_close" value="14:00" class="form-input text-xs">
                                                            <label class="flex items-center text-xs">
                                                                <input type="checkbox" id="sun_closed" checked class="form-checkbox mr-1">Closed
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>

                                                <!-- After Hours Handling -->
                                                <div class="pt-4 border-t">
                                                    <h5 class="font-medium text-gray-900 mb-3">After Hours Handling</h5>
                                                    <div class="space-y-3">
                                                        <label class="flex items-center">
                                                            <input type="radio" name="afterHoursHandling" value="take-message" checked class="form-radio">
                                                            <span class="ml-2 text-sm">Take a message</span>
                                                        </label>
                                                        <label class="flex items-center">
                                                            <input type="radio" name="afterHoursHandling" value="emergency-only" class="form-radio">
                                                            <span class="ml-2 text-sm">Emergency calls only</span>
                                                        </label>
                                                        <label class="flex items-center">
                                                            <input type="radio" name="afterHoursHandling" value="transfer-voicemail" class="form-radio">
                                                            <span class="ml-2 text-sm">Transfer to voicemail</span>
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Dashboard & Logs Tab -->
                                <div id="ai-dashboard-logs-tab" class="ai-config-tab-content hidden">
                                    <div class="space-y-6">
                                        <!-- Quick Stats -->
                                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                                            <div class="bg-white border border-gray-200 rounded-lg p-4">
                                                <div class="flex items-center justify-between">
                                                    <div>
                                                        <p class="text-sm font-medium text-gray-600">Today's Calls</p>
                                                        <p class="text-2xl font-bold text-gray-900">24</p>
                                                        <p class="text-xs text-green-600">
                                                            <i class="fas fa-arrow-up mr-1"></i>12% vs yesterday
                                                        </p>
                                                    </div>
                                                    <div class="text-blue-500">
                                                        <i class="fas fa-phone text-xl"></i>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="bg-white border border-gray-200 rounded-lg p-4">
                                                <div class="flex items-center justify-between">
                                                    <div>
                                                        <p class="text-sm font-medium text-gray-600">Avg Duration</p>
                                                        <p class="text-2xl font-bold text-gray-900">2:34</p>
                                                        <p class="text-xs text-green-600">
                                                            <i class="fas fa-arrow-up mr-1"></i>8% vs yesterday
                                                        </p>
                                                    </div>
                                                    <div class="text-green-500">
                                                        <i class="fas fa-clock text-xl"></i>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="bg-white border border-gray-200 rounded-lg p-4">
                                                <div class="flex items-center justify-between">
                                                    <div>
                                                        <p class="text-sm font-medium text-gray-600">Success Rate</p>
                                                        <p class="text-2xl font-bold text-gray-900">89%</p>
                                                        <p class="text-xs text-green-600">
                                                            <i class="fas fa-arrow-up mr-1"></i>3% vs yesterday
                                                        </p>
                                                    </div>
                                                    <div class="text-yellow-500">
                                                        <i class="fas fa-check-circle text-xl"></i>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="bg-white border border-gray-200 rounded-lg p-4">
                                                <div class="flex items-center justify-between">
                                                    <div>
                                                        <p class="text-sm font-medium text-gray-600">Agent Status</p>
                                                        <p class="text-lg font-bold text-green-600">Online</p>
                                                        <p class="text-xs text-gray-500">Last active: Now</p>
                                                    </div>
                                                    <div class="text-green-500">
                                                        <i class="fas fa-circle text-xl"></i>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Recent Activity -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <div class="flex justify-between items-center mb-4">
                                                <h4 class="text-lg font-semibold text-gray-900">Recent Call Activity</h4>
                                                <div class="flex gap-2">
                                                    <button class="text-indigo-600 hover:text-indigo-800 text-sm">
                                                        <i class="fas fa-refresh mr-1"></i>Refresh
                                                    </button>
                                                    <button class="text-indigo-600 hover:text-indigo-800 text-sm">
                                                        <i class="fas fa-download mr-1"></i>Export
                                                    </button>
                                                </div>
                                            </div>
                                            
                                            <div class="overflow-x-auto">
                                                <table class="min-w-full divide-y divide-gray-200">
                                                    <thead class="bg-gray-50">
                                                        <tr>
                                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Time</th>
                                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Caller</th>
                                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Duration</th>
                                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Outcome</th>
                                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody class="bg-white divide-y divide-gray-200">
                                                        <tr>
                                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">2:47 PM</td>
                                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">+1 (555) 123-4567</td>
                                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">3:21</td>
                                                            <td class="px-6 py-4 whitespace-nowrap">
                                                                <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">
                                                                    Appointment Scheduled
                                                                </span>
                                                            </td>
                                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                                                <button class="text-indigo-600 hover:text-indigo-900 mr-3">View</button>
                                                                <button class="text-green-600 hover:text-green-900">Listen</button>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">1:23 PM</td>
                                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">+1 (555) 987-6543</td>
                                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">1:45</td>
                                                            <td class="px-6 py-4 whitespace-nowrap">
                                                                <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800">
                                                                    Information Provided
                                                                </span>
                                                            </td>
                                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                                                <button class="text-indigo-600 hover:text-indigo-900 mr-3">View</button>
                                                                <button class="text-green-600 hover:text-green-900">Listen</button>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">12:15 PM</td>
                                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">+1 (555) 246-8135</td>
                                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">4:12</td>
                                                            <td class="px-6 py-4 whitespace-nowrap">
                                                                <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800">
                                                                    Emergency Transferred
                                                                </span>
                                                            </td>
                                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                                                <button class="text-indigo-600 hover:text-indigo-900 mr-3">View</button>
                                                                <button class="text-green-600 hover:text-green-900">Listen</button>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>

                                        <!-- Agent Performance -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4">Agent Performance Metrics</h4>
                                            
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                <div>
                                                    <h5 class="font-medium text-gray-900 mb-3">Response Quality</h5>
                                                    <div class="space-y-3">
                                                        <div class="flex justify-between items-center">
                                                            <span class="text-sm text-gray-600">Accuracy Score</span>
                                                            <span class="font-medium">94%</span>
                                                        </div>
                                                        <div class="w-full bg-gray-200 rounded-full h-2">
                                                            <div class="bg-green-600 h-2 rounded-full" style="width: 94%"></div>
                                                        </div>
                                                        
                                                        <div class="flex justify-between items-center">
                                                            <span class="text-sm text-gray-600">Helpfulness Rating</span>
                                                            <span class="font-medium">4.7/5.0</span>
                                                        </div>
                                                        <div class="w-full bg-gray-200 rounded-full h-2">
                                                            <div class="bg-blue-600 h-2 rounded-full" style="width: 94%"></div>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div>
                                                    <h5 class="font-medium text-gray-900 mb-3">Call Handling</h5>
                                                    <div class="space-y-3">
                                                        <div class="flex justify-between items-center">
                                                            <span class="text-sm text-gray-600">First Call Resolution</span>
                                                            <span class="font-medium">87%</span>
                                                        </div>
                                                        <div class="w-full bg-gray-200 rounded-full h-2">
                                                            <div class="bg-purple-600 h-2 rounded-full" style="width: 87%"></div>
                                                        </div>
                                                        
                                                        <div class="flex justify-between items-center">
                                                            <span class="text-sm text-gray-600">Transfer Rate</span>
                                                            <span class="font-medium">13%</span>
                                                        </div>
                                                        <div class="w-full bg-gray-200 rounded-full h-2">
                                                            <div class="bg-yellow-600 h-2 rounded-full" style="width: 13%"></div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Basic Setup Tab -->
                                <div id="ai-basic-tab" class="ai-config-tab-content hidden">
                                    <div class="space-y-6">
                                        <!-- Business Hours -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-clock mr-2 text-indigo-600"></i>Business Hours
                                            </h4>
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                <div>
                                                    <label class="form-label">Time Zone</label>
                                                    <select id="aiTimezone" class="form-select">
                                                        <option value="America/New_York">Eastern Time</option>
                                                        <option value="America/Chicago">Central Time</option>
                                                        <option value="America/Denver">Mountain Time</option>
                                                        <option value="America/Los_Angeles">Pacific Time</option>
                                                    </select>
                                                </div>
                                                <div>
                                                    <label class="form-label">Operating Mode</label>
                                                    <select id="aiOperatingMode" class="form-select">
                                                        <option value="business-hours">Business Hours Only</option>
                                                        <option value="24-7">24/7 Service</option>
                                                        <option value="extended">Extended Hours</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div id="businessHoursGrid" class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-4">
                                                <!-- Business hours will be populated here -->
                                            </div>
                                        </div>

                                        <!-- Contact Information -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-phone mr-2 text-indigo-600"></i>Contact & Routing
                                            </h4>
                                            <div class="space-y-4">
                                                <div>
                                                    <label class="form-label">Primary Transfer Number</label>
                                                    <input type="tel" id="aiPrimaryPhone" class="form-input" placeholder="+1 (555) 123-4567">
                                                </div>
                                                <div>
                                                    <label class="form-label">After-Hours Handling</label>
                                                    <select id="aiAfterHoursMode" class="form-select">
                                                        <option value="message">Take Message</option>
                                                        <option value="transfer">Transfer to On-Call</option>
                                                        <option value="voicemail">Send to Voicemail</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- AI Intelligence Tab -->
                                <div id="ai-intelligence-tab" class="ai-config-tab-content hidden">
                                    <div class="space-y-6">
                                        <!-- Super-Intelligence Configuration -->
                                        <div class="bg-gradient-to-r from-purple-50 to-indigo-50 border border-purple-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-brain mr-2 text-purple-600"></i>Super-Intelligence Engine
                                                <span class="ml-2 text-xs bg-purple-100 text-purple-800 px-2 py-1 rounded">ADVANCED</span>
                                            </h4>
                                            <p class="text-gray-700 mb-6">Transform your agent into a super-intelligent system with advanced reasoning, memory, and real-time adaptation capabilities.</p>
                                            
                                            <!-- Intelligence Level Toggle -->
                                            <div class="mb-6">
                                                <label class="flex items-center justify-between p-4 bg-white border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50">
                                                    <div class="flex items-center">
                                                        <div class="mr-4">
                                                            <h5 class="font-medium text-gray-900">Enable Super-Intelligence</h5>
                                                            <p class="text-sm text-gray-600">Activate advanced AI capabilities for human-like interactions</p>
                                                        </div>
                                                    </div>
                                                    <input type="checkbox" id="enableSuperIntelligence" class="sr-only peer">
                                                    <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-purple-600"></div>
                                                </label>
                                            </div>
                                        </div>

                                        <!-- Semantic Knowledge Base -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-search mr-2 text-blue-600"></i>Semantic Knowledge Retrieval
                                            </h4>
                                            
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                <!-- Vector Database Configuration -->
                                                <div>
                                                    <label class="form-label">Vector Database Provider</label>
                                                    <select id="vectorDbProvider" class="form-select">
                                                        <option value="pinecone">Pinecone (Recommended)</option>
                                                        <option value="weaviate">Weaviate</option>
                                                        <option value="faiss">FAISS (Local)</option>
                                                        <option value="chroma">ChromaDB</option>
                                                    </select>
                                                    <p class="text-xs text-gray-500 mt-1">Choose your vector database for semantic search</p>
                                                </div>
                                                
                                                <!-- Confidence Threshold -->
                                                <div>
                                                    <label class="form-label">Confidence Threshold</label>
                                                    <div class="flex items-center gap-3">
                                                        <input type="range" id="confidenceThreshold" min="0.5" max="1.0" step="0.05" value="0.85" class="flex-1">
                                                        <span id="confidenceValue" class="text-sm font-medium text-gray-700 min-w-[3rem]">85%</span>
                                                    </div>
                                                    <p class="text-xs text-gray-500 mt-1">Minimum confidence to provide answer (below = escalate)</p>
                                                </div>
                                                
                                                <!-- Embedding Model -->
                                                <div>
                                                    <label class="form-label">Embedding Model</label>
                                                    <select id="embeddingModel" class="form-select">
                                                        <option value="text-embedding-3-large">OpenAI Text-Embedding-3-Large</option>
                                                        <option value="text-embedding-3-small">OpenAI Text-Embedding-3-Small</option>
                                                        <option value="all-MiniLM-L6-v2">Sentence-Transformers MiniLM</option>
                                                        <option value="all-mpnet-base-v2">Sentence-Transformers MPNet</option>
                                                    </select>
                                                </div>
                                                
                                                <!-- Retrieval Strategy -->
                                                <div>
                                                    <label class="form-label">Retrieval Strategy</label>
                                                    <select id="retrievalStrategy" class="form-select">
                                                        <option value="semantic">Semantic Similarity</option>
                                                        <option value="hybrid">Hybrid (Semantic + Keyword)</option>
                                                        <option value="mmr">Maximum Marginal Relevance</option>
                                                        <option value="self-query">Self-Querying</option>
                                                    </select>
                                                </div>
                                            </div>
                                            
                                            <!-- Test Semantic Search -->
                                            <div class="mt-6 p-4 bg-gray-50 rounded-lg">
                                                <h5 class="font-medium text-gray-900 mb-3">Test Semantic Search</h5>
                                                <div class="flex gap-3">
                                                    <input type="text" id="testQuery" class="form-input flex-1" placeholder="Enter a test query...">
                                                    <button id="testSemanticBtn" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg">
                                                        <i class="fas fa-search mr-1"></i>Test
                                                    </button>
                                                </div>
                                                <div id="semanticResults" class="mt-3 hidden">
                                                    <!-- Results will be populated here -->
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Contextual Memory System -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-memory mr-2 text-green-600"></i>Contextual Memory System
                                            </h4>
                                            
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                <!-- Memory Provider -->
                                                <div>
                                                    <label class="form-label">Memory Provider</label>
                                                    <select id="memoryProvider" class="form-select">
                                                        <option value="memgpt">MemGPT (Recommended)</option>
                                                        <option value="zep">Zep Memory</option>
                                                        <option value="redis">Redis Cache</option>
                                                        <option value="local">Local Memory</option>
                                                    </select>
                                                </div>
                                                
                                                <!-- Session Memory Duration -->
                                                <div>
                                                    <label class="form-label">Session Memory Duration</label>
                                                    <select id="sessionDuration" class="form-select">
                                                        <option value="24h">24 Hours</option>
                                                        <option value="7d">7 Days</option>
                                                        <option value="30d" selected>30 Days</option>
                                                        <option value="90d">90 Days</option>
                                                        <option value="persistent">Persistent</option>
                                                    </select>
                                                </div>
                                                
                                                <!-- Memory Compression -->
                                                <div>
                                                    <label class="form-label">Memory Compression Threshold</label>
                                                    <div class="flex items-center gap-3">
                                                        <input type="range" id="memoryThreshold" min="1000" max="10000" step="500" value="5000" class="flex-1">
                                                        <span id="memoryValue" class="text-sm font-medium text-gray-700 min-w-[4rem]">5000 tokens</span>
                                                    </div>
                                                    <p class="text-xs text-gray-500 mt-1">Auto-compress conversation when threshold is reached</p>
                                                </div>
                                                
                                                <!-- Personalization Level -->
                                                <div>
                                                    <label class="form-label">Personalization Level</label>
                                                    <select id="personalizationLevel" class="form-select">
                                                        <option value="basic">Basic (Name, Phone)</option>
                                                        <option value="enhanced" selected>Enhanced (History, Preferences)</option>
                                                        <option value="deep">Deep (Behavioral Patterns)</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Dynamic Reasoning Engine -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-cogs mr-2 text-orange-600"></i>Dynamic Reasoning Engine (ReAct + DSPy)
                                            </h4>
                                            
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                <!-- Reasoning Framework -->
                                                <div>
                                                    <label class="form-label">Reasoning Framework</label>
                                                    <select id="reasoningFramework" class="form-select">
                                                        <option value="react" selected>ReAct (Reason + Act)</option>
                                                        <option value="cot">Chain of Thought</option>
                                                        <option value="tot">Tree of Thoughts</option>
                                                        <option value="reflexion">Reflexion</option>
                                                    </select>
                                                </div>
                                                
                                                <!-- DSPy Optimization -->
                                                <div>
                                                    <label class="form-label">DSPy Optimization</label>
                                                    <div class="space-y-3">
                                                        <label class="flex items-center">
                                                            <input type="checkbox" id="enableDspy" class="form-checkbox" checked>
                                                            <span class="ml-2 text-sm text-gray-700">Enable DSPy prompt optimization</span>
                                                        </label>
                                                        <label class="flex items-center">
                                                            <input type="checkbox" id="fewShotLearning" class="form-checkbox" checked>
                                                            <span class="ml-2 text-sm text-gray-700">Few-shot learning from examples</span>
                                                        </label>
                                                        <label class="flex items-center">
                                                            <input type="checkbox" id="bootstrapOptimization" class="form-checkbox">
                                                            <span class="ml-2 text-sm text-gray-700">Bootstrap optimization (slower, better)</span>
                                                        </label>
                                                    </div>
                                                </div>
                                                
                                                <!-- Reasoning Confidence -->
                                                <div>
                                                    <label class="form-label">Reasoning Confidence Threshold</label>
                                                    <div class="flex items-center gap-3">
                                                        <input type="range" id="reasoningConfidence" min="0.6" max="1.0" step="0.05" value="0.8" class="flex-1">
                                                        <span id="reasoningValue" class="text-sm font-medium text-gray-700 min-w-[3rem]">80%</span>
                                                    </div>
                                                    <p class="text-xs text-gray-500 mt-1">Minimum confidence for complex reasoning tasks</p>
                                                </div>
                                                
                                                <!-- Max Reasoning Steps -->
                                                <div>
                                                    <label class="form-label">Max Reasoning Steps</label>
                                                    <select id="maxReasoningSteps" class="form-select">
                                                        <option value="3">3 Steps</option>
                                                        <option value="5" selected>5 Steps</option>
                                                        <option value="7">7 Steps</option>
                                                        <option value="10">10 Steps</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Real-Time Sentiment & Escalation -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-heart mr-2 text-red-600"></i>Real-Time Sentiment & Auto-Escalation
                                            </h4>
                                            
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                <!-- Sentiment Provider -->
                                                <div>
                                                    <label class="form-label">Sentiment Analysis Provider</label>
                                                    <select id="sentimentProvider" class="form-select">
                                                        <option value="hume">Hume AI (Recommended)</option>
                                                        <option value="openai">OpenAI GPT-4</option>
                                                        <option value="assemblyai">AssemblyAI</option>
                                                        <option value="deepgram">Deepgram</option>
                                                    </select>
                                                </div>
                                                
                                                <!-- Escalation Sensitivity -->
                                                <div>
                                                    <label class="form-label">Escalation Sensitivity</label>
                                                    <div class="flex items-center gap-3">
                                                        <input type="range" id="escalationSensitivity" min="0.1" max="0.8" step="0.1" value="0.4" class="flex-1">
                                                        <span id="escalationValue" class="text-sm font-medium text-gray-700 min-w-[3rem]">0.4</span>
                                                    </div>
                                                    <p class="text-xs text-gray-500 mt-1">Lower = more sensitive to negative emotions</p>
                                                </div>
                                                
                                                <!-- Escalation Actions -->
                                                <div>
                                                    <label class="form-label">Auto-Escalation Actions</label>
                                                    <div class="space-y-3">
                                                        <label class="flex items-center">
                                                            <input type="checkbox" id="humanTransfer" class="form-checkbox" checked>
                                                            <span class="ml-2 text-sm text-gray-700">Transfer to human agent</span>
                                                        </label>
                                                        <label class="flex items-center">
                                                            <input type="checkbox" id="supervisorAlert" class="form-checkbox" checked>
                                                            <span class="ml-2 text-sm text-gray-700">Alert supervisor</span>
                                                        </label>
                                                        <label class="flex items-center">
                                                            <input type="checkbox" id="contextSummary" class="form-checkbox" checked>
                                                            <span class="ml-2 text-sm text-gray-700">Generate context summary</span>
                                                        </label>
                                                    </div>
                                                </div>
                                                
                                                <!-- Emotion Detection -->
                                                <div>
                                                    <label class="form-label">Emotion Detection Frequency</label>
                                                    <select id="emotionFrequency" class="form-select">
                                                        <option value="continuous">Continuous (Real-time)</option>
                                                        <option value="5s" selected>Every 5 seconds</option>
                                                        <option value="10s">Every 10 seconds</option>
                                                        <option value="turn">Per conversation turn</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Performance Optimization -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-tachometer-alt mr-2 text-purple-600"></i>Performance Optimization
                                            </h4>
                                            
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                <!-- Model Selection -->
                                                <div>
                                                    <label class="form-label">Primary AI Model</label>
                                                    <select id="primaryModel" class="form-select">
                                                        <option value="gemini-2.0-flash-exp">Gemini 2.0 Flash (Recommended)</option>
                                                        <option value="gpt-4-turbo">GPT-4 Turbo</option>
                                                        <option value="claude-3-5-sonnet">Claude 3.5 Sonnet</option>
                                                        <option value="gpt-4o">GPT-4o</option>
                                                    </select>
                                                    <p class="text-xs text-gray-500 mt-1">Primary model for conversation and reasoning</p>
                                                </div>
                                                
                                                <!-- Response Latency Target -->
                                                <div>
                                                    <label class="form-label">Response Latency Target</label>
                                                    <select id="latencyTarget" class="form-select">
                                                        <option value="300ms">Ultra-Fast (300ms)</option>
                                                        <option value="500ms" selected>Fast (500ms)</option>
                                                        <option value="800ms">Standard (800ms)</option>
                                                        <option value="1200ms">Relaxed (1200ms)</option>
                                                    </select>
                                                </div>
                                                
                                                <!-- Streaming Configuration -->
                                                <div>
                                                    <label class="form-label">Response Streaming</label>
                                                    <div class="space-y-3">
                                                        <label class="flex items-center">
                                                            <input type="checkbox" id="enableStreaming" class="form-checkbox" checked>
                                                            <span class="ml-2 text-sm text-gray-700">Enable response streaming</span>
                                                        </label>
                                                        <label class="flex items-center">
                                                            <input type="checkbox" id="interruptHandling" class="form-checkbox" checked>
                                                            <span class="ml-2 text-sm text-gray-700">Handle interruptions gracefully</span>
                                                        </label>
                                                        <label class="flex items-center">
                                                            <input type="checkbox" id="websocketMode" class="form-checkbox">
                                                            <span class="ml-2 text-sm text-gray-700">WebSocket mode (lower latency)</span>
                                                        </label>
                                                    </div>
                                                </div>
                                                
                                                <!-- Caching Strategy -->
                                                <div>
                                                    <label class="form-label">Response Caching</label>
                                                    <select id="cachingStrategy" class="form-select">
                                                        <option value="aggressive">Aggressive (Fast, less dynamic)</option>
                                                        <option value="balanced" selected>Balanced (Good compromise)</option>
                                                        <option value="minimal">Minimal (Slower, more dynamic)</option>
                                                        <option value="disabled">Disabled</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Continuous Learning -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-graduation-cap mr-2 text-indigo-600"></i>Continuous Learning & Improvement
                                            </h4>
                                            
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                <!-- Learning Rate -->
                                                <div>
                                                    <label class="form-label">Learning Aggressiveness</label>
                                                    <div class="flex items-center gap-3">
                                                        <input type="range" id="learningRate" min="0.1" max="1.0" step="0.1" value="0.5" class="flex-1">
                                                        <span id="learningValue" class="text-sm font-medium text-gray-700 min-w-[3rem]">0.5</span>
                                                    </div>
                                                    <p class="text-xs text-gray-500 mt-1">How quickly the agent adapts from new interactions</p>
                                                </div>
                                                
                                                <!-- Evaluation Framework -->
                                                <div>
                                                    <label class="form-label">Evaluation Framework</label>
                                                    <select id="evaluationFramework" class="form-select">
                                                        <option value="langsmith" selected>LangSmith</option>
                                                        <option value="weights-biases">Weights & Biases</option>
                                                        <option value="mlflow">MLflow</option>
                                                        <option value="custom">Custom Analytics</option>
                                                    </select>
                                                </div>
                                                
                                                <!-- Auto-Improvement -->
                                                <div>
                                                    <label class="form-label">Auto-Improvement Features</label>
                                                    <div class="space-y-3">
                                                        <label class="flex items-center">
                                                            <input type="checkbox" id="autoFailureAnalysis" class="form-checkbox" checked>
                                                            <span class="ml-2 text-sm text-gray-700">Automatic failure analysis</span>
                                                        </label>
                                                        <label class="flex items-center">
                                                            <input type="checkbox" id="promptRetraining" class="form-checkbox" checked>
                                                            <span class="ml-2 text-sm text-gray-700">Auto-retrain prompts weekly</span>
                                                        </label>
                                                        <label class="flex items-center">
                                                            <input type="checkbox" id="abTesting" class="form-checkbox">
                                                            <span class="ml-2 text-sm text-gray-700">A/B test new capabilities</span>
                                                        </label>
                                                    </div>
                                                </div>
                                                
                                                <!-- Performance Metrics -->
                                                <div>
                                                    <label class="form-label">Track Performance Metrics</label>
                                                    <div class="space-y-3">
                                                        <label class="flex items-center">
                                                            <input type="checkbox" id="trackLatency" class="form-checkbox" checked>
                                                            <span class="ml-2 text-sm text-gray-700">Response latency</span>
                                                        </label>
                                                        <label class="flex items-center">
                                                            <input type="checkbox" id="trackAccuracy" class="form-checkbox" checked>
                                                            <span class="ml-2 text-sm text-gray-700">Answer accuracy</span>
                                                        </label>
                                                        <label class="flex items-center">
                                                            <input type="checkbox" id="trackSentiment" class="form-checkbox" checked>
                                                            <span class="ml-2 text-sm text-gray-700">Customer satisfaction</span>
                                                        </label>
                                                        <label class="flex items-center">
                                                            <input type="checkbox" id="trackEscalations" class="form-checkbox" checked>
                                                            <span class="ml-2 text-sm text-gray-700">Escalation rate</span>
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Intelligence Test Suite -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-flask mr-2 text-green-600"></i>Intelligence Test Suite
                                            </h4>
                                            <p class="text-gray-600 mb-4">Test your agent's capabilities with simulated scenarios.</p>
                                            
                                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                                <button id="testMemoryBtn" class="p-4 border border-gray-200 rounded-lg text-center hover:bg-gray-50">
                                                    <i class="fas fa-memory text-2xl text-blue-600 mb-2"></i>
                                                    <div class="font-medium text-gray-900">Memory Test</div>
                                                    <div class="text-xs text-gray-600">Test context retention</div>
                                                </button>
                                                
                                                <button id="testReasoningBtn" class="p-4 border border-gray-200 rounded-lg text-center hover:bg-gray-50">
                                                    <i class="fas fa-cogs text-2xl text-orange-600 mb-2"></i>
                                                    <div class="font-medium text-gray-900">Reasoning Test</div>
                                                    <div class="text-xs text-gray-600">Test problem-solving</div>
                                                </button>
                                                
                                                <button id="testEscalationBtn" class="p-4 border border-gray-200 rounded-lg text-center hover:bg-gray-50">
                                                    <i class="fas fa-level-up-alt text-2xl text-red-600 mb-2"></i>
                                                    <div class="font-medium text-gray-900">Escalation Test</div>
                                                    <div class="text-xs text-gray-600">Test sentiment handling</div>
                                                </button>
                                            </div>
                                            
                                            <div id="testResults" class="mt-4 hidden">
                                                <!-- Test results will be populated here -->
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Call Workflows Tab -->
                                <div id="ai-workflows-tab" class="ai-config-tab-content hidden">
                                    <div class="space-y-6">
                                        <!-- During Call Actions -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-phone mr-2 text-blue-600"></i>During Call Actions
                                                <span class="ml-2 text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded">Real-time</span>
                                            </h4>
                                            <p class="text-gray-600 mb-4">Configure actions that the AI agent performs while actively on a call.</p>
                                            
                                            <div class="mb-4 flex items-center gap-3">
                                                <select id="duringCallActionType" class="form-select">
                                                    <option value="extract-data">Extract & Store Data</option>
                                                    <option value="call-transfer">Call Transfer</option>
                                                    <option value="trigger-workflow">Trigger Workflow</option>
                                                    <option value="send-notification">Send Notification</option>
                                                </select>
                                                <button id="addDuringCallActionBtn" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg flex items-center">
                                                    <i class="fas fa-plus mr-2"></i>Add Action
                                                </button>
                                            </div>
                                            
                                            <div id="duringCallActionsList" class="space-y-3">
                                                <!-- Actions will be populated here -->
                                            </div>
                                        </div>

                                        <!-- After Call Actions -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-phone-slash mr-2 text-green-600"></i>After Call Actions
                                                <span class="ml-2 text-xs bg-green-100 text-green-800 px-2 py-1 rounded">Post-call</span>
                                            </h4>
                                            <p class="text-gray-600 mb-4">Configure actions that happen automatically after the call ends.</p>
                                            
                                            <div class="mb-4 flex items-center gap-3">
                                                <select id="afterCallActionType" class="form-select">
                                                    <option value="call-transfer">Transfer to Team Member</option>
                                                    <option value="send-sms">Send SMS</option>
                                                    <option value="book-appointment">Book Appointment</option>
                                                    <option value="update-contact">Update Contact Field</option>
                                                    <option value="email-notification">Email Notification</option>
                                                </select>
                                                <button id="addAfterCallActionBtn" class="bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-lg flex items-center">
                                                    <i class="fas fa-plus mr-2"></i>Add Action
                                                </button>
                                            </div>
                                            
                                            <div id="afterCallActionsList" class="space-y-3">
                                                <!-- Actions will be populated here -->
                                            </div>
                                        </div>

                                        <!-- Call Settings -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-cogs mr-2 text-indigo-600"></i>Call Management Settings
                                            </h4>
                                            
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                <div>
                                                    <label class="form-label">Maximum Call Duration</label>
                                                    <div class="flex items-center gap-3">
                                                        <input type="range" id="aiCallTimeLimit" min="1" max="30" value="10" class="flex-1">
                                                        <span id="callTimeLimitValue" class="text-sm font-medium">10 mins</span>
                                                    </div>
                                                </div>
                                                
                                                <div>
                                                    <label class="form-label">Idle Time Before Reminder</label>
                                                    <select id="aiIdleTime" class="form-select">
                                                        <option value="5">5 seconds</option>
                                                        <option value="8" selected>8 seconds</option>
                                                        <option value="10">10 seconds</option>
                                                        <option value="15">15 seconds</option>
                                                    </select>
                                                </div>
                                                
                                                <div class="md:col-span-2">
                                                    <h5 class="font-medium text-gray-900 mb-3">Call Handling Options</h5>
                                                    <div class="space-y-2">
                                                        <label class="flex items-center">
                                                            <input type="checkbox" id="aiIdleTimeReminder" class="form-checkbox" checked>
                                                            <span class="form-check-label">Send idle time reminders</span>
                                                        </label>
                                                        <label class="flex items-center">
                                                            <input type="checkbox" id="aiEmailNotifications" class="form-checkbox" checked>
                                                            <span class="form-check-label">Email notifications for important calls</span>
                                                        </label>
                                                        <label class="flex items-center">
                                                            <input type="checkbox" id="aiCallRecording" class="form-checkbox" checked>
                                                            <span class="form-check-label">Record all calls</span>
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="ai-scheduling-tab" class="ai-config-tab-content hidden">
                                    <div class="space-y-6">
                                        <!-- HVAC Service Types with Specific Scheduling -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-wrench mr-2 text-indigo-600"></i>HVAC Service Types & Scheduling Rules
                                                <span class="ml-2 text-xs bg-green-100 text-green-800 px-2 py-1 rounded">Penguin Air Ready</span>
                                            </h4>
                                            <p class="text-gray-600 mb-6">Predefined HVAC service types with intelligent scheduling rules based on your script protocols.</p>
                                            
                                            <!-- Repair Service Configuration -->
                                            <div class="mb-6 p-4 bg-red-50 border border-red-200 rounded-lg">
                                                <h5 class="text-lg font-semibold text-red-800 mb-3 flex items-center">
                                                    <i class="fas fa-tools mr-2"></i>Repair Service Scheduling
                                                </h5>
                                                
                                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                    <div>
                                                        <label class="form-label">Standard Time Slots</label>
                                                        <textarea rows="6" class="form-input text-sm font-mono has-default-content" readonly>Morning: 8–10 AM, 10–12 PM
Afternoon: 12–2 PM, 2–4 PM, 4–6 PM
Evening: 6–8 PM (until 5:30 PM only)

Buffer Time: 2 hours from call time
Exception: 6–8 PM if booked by 5:30 PM
Never book past 8:00 PM</textarea>
                                                    </div>
                                                    <div>
                                                        <label class="form-label">Scheduling Rules</label>
                                                        <div class="space-y-3">
                                                            <div class="flex items-center justify-between p-2 bg-white rounded border">
                                                                <span class="text-sm">2-hour buffer from call time</span>
                                                                <input type="checkbox" class="form-checkbox" checked disabled>
                                                            </div>
                                                            <div class="flex items-center justify-between p-2 bg-white rounded border">
                                                                <span class="text-sm">Round up to next full hour</span>
                                                                <input type="checkbox" class="form-checkbox" checked disabled>
                                                            </div>
                                                            <div class="flex items-center justify-between p-2 bg-white rounded border">
                                                                <span class="text-sm">6-8 PM only if by 5:30 PM</span>
                                                                <input type="checkbox" class="form-checkbox" checked disabled>
                                                            </div>
                                                            <div class="flex items-center justify-between p-2 bg-white rounded border">
                                                                <span class="text-sm">No booking past 8:00 PM</span>
                                                                <input type="checkbox" class="form-checkbox" checked disabled>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div class="mt-4 p-3 bg-white rounded border">
                                                    <h6 class="font-medium mb-2">Example Scheduling Logic</h6>
                                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                                                        <div class="p-2 bg-gray-50 rounded">
                                                            <strong>Call at 10:15 AM</strong><br>
                                                            <span class="text-blue-600">→ Offer 1–3 PM slot</span>
                                                        </div>
                                                        <div class="p-2 bg-gray-50 rounded">
                                                            <strong>Call at 5:15 PM</strong><br>
                                                            <span class="text-blue-600">→ Offer 6–8 PM slot</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Maintenance Service Configuration -->
                                            <div class="mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                                                <h5 class="text-lg font-semibold text-blue-800 mb-3 flex items-center">
                                                    <i class="fas fa-calendar-check mr-2"></i>Maintenance Service Scheduling
                                                </h5>
                                                
                                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                    <div>
                                                        <label class="form-label">Maintenance Schedule</label>
                                                        <div class="space-y-3">
                                                            <div class="p-3 bg-white rounded border">
                                                                <div class="flex items-center justify-between">
                                                                    <span class="text-sm font-medium">Standard booking time</span>
                                                                    <span class="text-blue-600 font-semibold">About a week out</span>
                                                                </div>
                                                            </div>
                                                            <div class="p-3 bg-white rounded border">
                                                                <div class="flex items-center justify-between">
                                                                    <span class="text-sm font-medium">Time preference</span>
                                                                    <span class="text-blue-600 font-semibold">Morning or Afternoon</span>
                                                                </div>
                                                            </div>
                                                            <div class="p-3 bg-white rounded border">
                                                                <div class="flex items-center justify-between">
                                                                    <span class="text-sm font-medium">Date confirmation</span>
                                                                    <span class="text-blue-600 font-semibold">Full date with day</span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div>
                                                        <label class="form-label">Maintenance Protocol Script</label>
                                                        <textarea rows="6" class="form-input text-sm font-mono has-default-content" readonly>Say: "Maintenance visits are booking about a week out."
Ask: "What day works best for you?"
Confirm: "Just to confirm, [Day], [Full Date], correct?"
Ask: "Morning or afternoon preferred?"
If wants sooner: Transfer to Service Advisor</textarea>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Emergency Service Configuration -->
                                            <div class="mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                                                <h5 class="text-lg font-semibold text-yellow-800 mb-3 flex items-center">
                                                    <i class="fas fa-exclamation-triangle mr-2"></i>Emergency Service Handling
                                                </h5>
                                                
                                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                    <div>
                                                        <label class="form-label">Emergency Hours (ET)</label>
                                                        <div class="space-y-2">
                                                            <div class="p-2 bg-white rounded border flex justify-between">
                                                                <span class="text-sm">Business Hours</span>
                                                                <span class="font-semibold text-green-600">7:00 AM – 7:00 PM</span>
                                                            </div>
                                                            <div class="p-2 bg-white rounded border flex justify-between">
                                                                <span class="text-sm">After Hours</span>
                                                                <span class="font-semibold text-red-600">7:00 PM – 7:00 AM</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div>
                                                        <label class="form-label">Emergency Protocols</label>
                                                        <div class="space-y-2 text-sm">
                                                            <div class="p-2 bg-white rounded border">
                                                                <strong>Business Hours:</strong> Transfer to Emergency Team
                                                            </div>
                                                            <div class="p-2 bg-white rounded border">
                                                                <strong>After Hours:</strong> Schedule or Take Message
                                                            </div>
                                                            <div class="p-2 bg-white rounded border">
                                                                <strong>Transfer Fails:</strong> System Delay/Reboot Protocol
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Scheduling Intelligence -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-brain mr-2 text-indigo-600"></i>Intelligent Scheduling Features
                                            </h4>
                                            
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                <div>
                                                    <h5 class="font-medium text-gray-900 mb-3">Automated Features</h5>
                                                    <div class="space-y-3">
                                                        <label class="flex items-center">
                                                            <input type="checkbox" id="aiSmartScheduling" class="form-checkbox" checked>
                                                            <span class="form-check-label">Smart availability detection</span>
                                                        </label>
                                                        <label class="flex items-center">
                                                            <input type="checkbox" id="aiBufferTime" class="form-checkbox" checked>
                                                            <span class="form-check-label">Automatic 2-hour buffer for repairs</span>
                                                        </label>
                                                        <label class="flex items-center">
                                                            <input type="checkbox" id="aiDoubleBookingPrevention" class="form-checkbox" checked>
                                                            <span class="form-check-label">Prevent double-booking</span>
                                                        </label>
                                                        <label class="flex items-center">
                                                            <input type="checkbox" id="aiTimeZoneDetection" class="form-checkbox" checked>
                                                            <span class="form-check-label">Eastern Time zone enforcement</span>
                                                        </label>
                                                    </div>
                                                </div>
                                                <div>
                                                    <h5 class="font-medium text-gray-900 mb-3">Call Routing Rules</h5>
                                                    <div class="space-y-3">
                                                        <label class="flex items-center">
                                                            <input type="checkbox" id="aiServiceTypeDetection" class="form-checkbox" checked>
                                                            <span class="form-check-label">Auto-detect repair vs maintenance</span>
                                                        </label>
                                                        <label class="flex items-center">
                                                            <input type="checkbox" id="aiEmergencyDetection" class="form-checkbox" checked>
                                                            <span class="form-check-label">Emergency keyword detection</span>
                                                        </label>
                                                        <label class="flex items-center">
                                                            <input type="checkbox" id="aiTransferProtocol" class="form-checkbox" checked>
                                                            <span class="form-check-label">Automatic transfer protocols</span>
                                                        </label>
                                                        <label class="flex items-center">
                                                            <input type="checkbox" id="aiConfusedCallerHelp" class="form-checkbox" checked>
                                                            <span class="form-check-label">Confused caller assistance</span>
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Time Slot Configuration -->
                                            <div class="mt-6 p-4 bg-gray-50 rounded-lg">
                                                <h5 class="font-medium text-gray-900 mb-3">Standard Time Slot Configuration</h5>
                                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                                    <div>
                                                        <label class="form-label text-sm">Morning Slots</label>
                                                        <select class="form-select text-sm has-default-content">
                                                            <option selected>8–10 AM, 10–12 PM</option>
                                                            <option>8–11 AM, 11–1 PM</option>
                                                            <option>9–12 PM (3-hour blocks)</option>
                                                        </select>
                                                    </div>
                                                    <div>
                                                        <label class="form-label text-sm">Afternoon Slots</label>
                                                        <select class="form-select text-sm has-default-content">
                                                            <option selected>12–2 PM, 2–4 PM, 4–6 PM</option>
                                                            <option>1–3 PM, 3–5 PM, 5–7 PM</option>
                                                            <option>12–3 PM, 3–6 PM (3-hour blocks)</option>
                                                        </select>
                                                    </div>
                                                    <div>
                                                        <label class="form-label text-sm">Evening Cutoff</label>
                                                        <select class="form-select text-sm has-default-content">
                                                            <option selected>8:00 PM (No booking past)</option>
                                                            <option>7:00 PM (Earlier cutoff)</option>
                                                            <option>9:00 PM (Later cutoff)</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Service Advisor Transfer Rules -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-user-tie mr-2 text-purple-600"></i>Service Advisor Transfer Rules
                                            </h4>
                                            
                                            <div class="space-y-4">
                                                <div class="p-4 bg-purple-50 rounded-lg">
                                                    <h5 class="font-medium text-purple-900 mb-2">Automatic Transfer Triggers</h5>
                                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                                                        <div>
                                                            <strong>Schedule-Related Requests:</strong>
                                                            <ul class="mt-1 text-gray-700 space-y-1">
                                                                <li>• Appointment time inquiries</li>
                                                                <li>• Technician status questions</li>
                                                                <li>• Schedule changes</li>
                                                                <li>• Appointment cancellations</li>
                                                                <li>• Confirmations</li>
                                                            </ul>
                                                        </div>
                                                        <div>
                                                            <strong>When in Doubt Scenarios:</strong>
                                                            <ul class="mt-1 text-gray-700 space-y-1">
                                                                <li>• Customer frustration detected</li>
                                                                <li>• Unclear requests</li>
                                                                <li>• Complex scheduling needs</li>
                                                                <li>• System failures</li>
                                                                <li>• Confused about service type</li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                    <div>
                                                        <label class="form-label">Transfer Script</label>
                                                        <textarea rows="4" class="form-input text-sm font-mono has-default-content" readonly>Say: "To assist with your schedule, I'm transferring you to a service advisor. Please hold for just a moment."
Transfer to Service Advisor.
If transfer fails, follow System Delay/Reboot Protocol.</textarea>
                                                    </div>
                                                    <div>
                                                        <label class="form-label">When in Doubt Script</label>
                                                        <textarea rows="4" class="form-input text-sm font-mono has-default-content" readonly>Say: "Ok, to ensure you get the best help, I'm transferring you to a service advisor who can assist with your service needs. Please hold."
Transfer to Service Advisor.</textarea>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Quote Request Settings -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-calculator mr-2 text-green-600"></i>Quote & Billing Request Handling
                                            </h4>
                                            
                                            <div class="space-y-4">
                                                <div class="p-4 bg-green-50 rounded-lg">
                                                    <h5 class="font-medium text-green-900 mb-2">Steven Ferris Transfer Keywords</h5>
                                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                        <div>
                                                            <label class="form-label text-sm">Transfer Keywords</label>
                                                            <textarea rows="4" class="form-input text-sm has-default-content" readonly>Steve
Invoices
Billing
Duct cleaning</textarea>
                                                        </div>
                                                        <div>
                                                            <label class="form-label text-sm">Quote Keywords</label>
                                                            <textarea rows="4" class="form-input text-sm has-default-content" readonly>System pricing
Parts estimates
Quotes
Cost estimate</textarea>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div>
                                                    <label class="form-label">Pre-Transfer Information Collection</label>
                                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                        <div class="space-y-2">
                                                            <label class="flex items-center">
                                                                <input type="checkbox" class="form-checkbox" checked disabled>
                                                                <span class="ml-2 text-sm">Full name</span>
                                                            </label>
                                                            <label class="flex items-center">
                                                                <input type="checkbox" class="form-checkbox" checked disabled>
                                                                <span class="ml-2 text-sm">Address</span>
                                                            </label>
                                                        </div>
                                                        <div class="space-y-2">
                                                            <label class="flex items-center">
                                                                <input type="checkbox" class="form-checkbox" checked disabled>
                                                                <span class="ml-2 text-sm">Best contact number</span>
                                                            </label>
                                                            <label class="flex items-center">
                                                                <input type="checkbox" class="form-checkbox" checked disabled>
                                                                <span class="ml-2 text-sm">Purpose of call</span>
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                                        <span class="form-check-label">Suggest optimal times</span>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Live Scheduling Preview -->
                                        <div id="aiSchedulingPreview" class="bg-blue-50 border border-blue-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-blue-900 mb-4 flex items-center">
                                                <i class="fas fa-eye mr-2"></i>Live Scheduling Preview
                                            </h4>
                                            <div id="schedulingPreviewContent" class="text-blue-800">
                                                Configure your services above to see how the AI will handle scheduling requests.
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Knowledge Base Tab -->
                                <div id="ai-knowledge-tab" class="ai-config-tab-content hidden">
                                    <div class="space-y-6">
                                        <!-- Auto-Population Tools -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-magic mr-2 text-indigo-600"></i>Auto-Population Tools
                                                <span class="ml-2 text-xs bg-green-100 text-green-800 px-2 py-1 rounded">ClientsVia Advantage</span>
                                            </h4>
                                            
                                            <!-- Website Auto-Population -->
                                            <div class="mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                                                <h5 class="text-md font-medium text-blue-900 mb-3 flex items-center">
                                                    <i class="fas fa-globe mr-2"></i>Extract from Website
                                                </h5>
                                                <p class="text-blue-800 text-sm mb-3">Automatically extract Q&As from your business website.</p>
                                                <div class="flex flex-col sm:flex-row gap-3">
                                                    <input type="url" id="websiteUrlInput" class="form-input flex-1" placeholder="https://yourbusiness.com">
                                                    <button id="extractFromWebsiteBtn" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg text-sm whitespace-nowrap">
                                                        <i class="fas fa-download mr-1"></i>Extract Knowledge
                                                    </button>
                                                </div>
                                            </div>

                                            <!-- Bulk Import Options -->
                                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                                                <div class="p-4 border border-gray-200 rounded-lg text-center">
                                                    <i class="fas fa-file-csv text-2xl text-green-600 mb-2"></i>
                                                    <h6 class="font-medium text-gray-900 mb-1">CSV Import</h6>
                                                    <p class="text-xs text-gray-600 mb-3">Import from CSV file</p>
                                                    <input type="file" id="csvFileInput" accept=".csv" class="hidden">
                                                    <button onclick="document.getElementById('csvFileInput').click()" class="text-green-600 hover:text-green-800 text-sm">
                                                        <i class="fas fa-upload mr-1"></i>Upload CSV
                                                    </button>
                                                </div>
                                                
                                                <div class="p-4 border border-gray-200 rounded-lg text-center">
                                                    <i class="fas fa-file-alt text-2xl text-blue-600 mb-2"></i>
                                                    <h6 class="font-medium text-gray-900 mb-1">JSON Import</h6>
                                                    <p class="text-xs text-gray-600 mb-3">Import from JSON file</p>
                                                    <input type="file" id="jsonFileInput" accept=".json" class="hidden">
                                                    <button onclick="document.getElementById('jsonFileInput').click()" class="text-blue-600 hover:text-blue-800 text-sm">
                                                        <i class="fas fa-upload mr-1"></i>Upload JSON
                                                    </button>
                                                </div>
                                                
                                                <div class="p-4 border border-gray-200 rounded-lg text-center">
                                                    <i class="fas fa-question-circle text-2xl text-purple-600 mb-2"></i>
                                                    <h6 class="font-medium text-gray-900 mb-1">Existing FAQ</h6>
                                                    <p class="text-xs text-gray-600 mb-3">Copy from existing FAQ</p>
                                                    <button id="importExistingFAQBtn" class="text-purple-600 hover:text-purple-800 text-sm">
                                                        <i class="fas fa-copy mr-1"></i>Import FAQ
                                                    </button>
                                                </div>
                                            </div>

                                            <!-- Knowledge Gap Analysis -->
                                            <div class="p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                                                <h5 class="text-md font-medium text-yellow-900 mb-2 flex items-center">
                                                    <i class="fas fa-search mr-2"></i>Knowledge Gap Analysis
                                                </h5>
                                                <p class="text-yellow-800 text-sm mb-3">Analyze recent calls to find missing knowledge areas.</p>
                                                <button id="analyzeKnowledgeGapsBtn" class="bg-yellow-600 hover:bg-yellow-700 text-white py-2 px-4 rounded-lg text-sm">
                                                    <i class="fas fa-brain mr-1"></i>Analyze Gaps
                                                </button>
                                            </div>
                                        </div>

                                        <!-- Auto-Generated Knowledge -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-robot mr-2 text-indigo-600"></i>Auto-Generated Knowledge
                                            </h4>
                                            <p class="text-gray-600 mb-4">Your business categories automatically populate relevant Q&As. Review and customize as needed.</p>
                                            
                                            <!-- Selected Categories Display -->
                                            <div class="mb-4">
                                                <label class="form-label">Selected Business Categories</label>
                                                <div id="aiSelectedCategories" class="flex flex-wrap gap-2 mt-2">
                                                    <span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm">No categories selected</span>
                                                </div>
                                                <button id="editCategoriesBtn" class="mt-2 text-indigo-600 hover:text-indigo-800 text-sm">
                                                    <i class="fas fa-edit mr-1"></i>Edit Categories
                                                </button>
                                            </div>

                                            <!-- Auto-Generated Q&As -->
                                            <div id="aiAutoQAs" class="space-y-3 max-h-60 overflow-y-auto border border-gray-200 rounded-lg p-4">
                                                <div class="text-center text-gray-500">
                                                    <i class="fas fa-robot text-2xl mb-2"></i>
                                                    <p>Select business categories to see auto-generated Q&As</p>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Custom Q&As -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-plus-circle mr-2 text-indigo-600"></i>Custom Q&As
                                            </h4>
                                            
                                            <!-- Quick Add Form -->
                                            <div class="mb-4 p-4 bg-gray-50 rounded-lg">
                                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                    <div>
                                                        <label class="form-label text-sm">Question</label>
                                                        <input type="text" id="aiCustomQuestion" class="form-input" placeholder="What are your hours?">
                                                    </div>
                                                    <div>
                                                        <label class="form-label text-sm">Answer</label>
                                                        <input type="text" id="aiCustomAnswer" class="form-input" placeholder="We're open Monday-Friday 9am-5pm">
                                                    </div>
                                                </div>
                                                <button id="addCustomQABtn" class="mt-3 bg-indigo-600 hover:bg-indigo-700 text-white py-2 px-4 rounded-lg text-sm">
                                                    <i class="fas fa-plus mr-1"></i>Add Q&A
                                                </button>
                                            </div>

                                            <!-- Custom Q&As List -->
                                            <div id="aiCustomQAsList" class="space-y-2">
                                                <div class="text-center text-gray-500 py-4">
                                                    <i class="fas fa-question-circle text-2xl mb-2"></i>
                                                    <p>No custom Q&As added yet</p>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Knowledge Learning -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-brain mr-2 text-indigo-600"></i>AI Learning Settings
                                            </h4>
                                            <div class="space-y-3">
                                                <label class="flex items-center">
                                                    <input type="checkbox" id="aiAutoLearning" class="form-checkbox" checked>
                                                    <span class="form-check-label">Learn from conversations automatically</span>
                                                </label>
                                                <label class="flex items-center">
                                                    <input type="checkbox" id="aiSuggestAnswers" class="form-checkbox" checked>
                                                    <span class="form-check-label">Suggest new Q&As from call patterns</span>
                                                </label>
                                                <label class="flex items-center">
                                                    <input type="checkbox" id="aiNotifyLearning" class="form-checkbox">
                                                    <span class="form-check-label">Email me when new knowledge is learned</span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Analytics Tab -->
                                <div id="ai-analytics-tab" class="ai-config-tab-content hidden">
                                    <div class="space-y-6">
                                        <!-- Analytics Overview -->
                                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                                            <div class="bg-white border border-gray-200 rounded-lg p-4">
                                                <div class="flex items-center justify-between">
                                                    <div>
                                                        <p class="text-sm font-medium text-gray-600">Total Calls</p>
                                                        <p id="analyticsTotalCalls" class="text-2xl font-bold text-gray-900">190</p>
                                                        <p class="text-xs text-red-600">
                                                            <i class="fas fa-arrow-down mr-1"></i>58% vs last month
                                                        </p>
                                                    </div>
                                                    <div class="text-blue-500">
                                                        <i class="fas fa-phone text-xl"></i>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="bg-white border border-gray-200 rounded-lg p-4">
                                                <div class="flex items-center justify-between">
                                                    <div>
                                                        <p class="text-sm font-medium text-gray-600">Actions Triggered</p>
                                                        <p id="analyticsActionsTriggered" class="text-2xl font-bold text-gray-900">100</p>
                                                        <p class="text-xs text-red-600">
                                                            <i class="fas fa-arrow-down mr-1"></i>67% vs last month
                                                        </p>
                                                    </div>
                                                    <div class="text-green-500">
                                                        <i class="fas fa-cogs text-xl"></i>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="bg-white border border-gray-200 rounded-lg p-4">
                                                <div class="flex items-center justify-between">
                                                    <div>
                                                        <p class="text-sm font-medium text-gray-600">Sentiment</p>
                                                        <p id="analyticsSentiment" class="text-2xl font-bold text-gray-900">58% Positive</p>
                                                        <p class="text-xs text-red-600">
                                                            <i class="fas fa-arrow-down mr-1"></i>4% vs last month
                                                        </p>
                                                    </div>
                                                    <div class="text-yellow-500">
                                                        <i class="fas fa-smile text-xl"></i>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="bg-white border border-gray-200 rounded-lg p-4">
                                                <div class="flex items-center justify-between">
                                                    <div>
                                                        <p class="text-sm font-medium text-gray-600">Avg Duration</p>
                                                        <p id="analyticsAvgDuration" class="text-2xl font-bold text-gray-900">0.5 Mins</p>
                                                        <p class="text-xs text-red-600">
                                                            <i class="fas fa-arrow-down mr-1"></i>17% vs last month
                                                        </p>
                                                    </div>
                                                    <div class="text-purple-500">
                                                        <i class="fas fa-clock text-xl"></i>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Charts Row -->
                                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                            <!-- Call Volume Chart -->
                                            <div class="bg-white border border-gray-200 rounded-lg p-6">
                                                <h4 class="text-lg font-semibold text-gray-900 mb-4">Calls Completed</h4>
                                                <div id="callVolumeChart" class="h-64 flex items-center justify-center border border-gray-200 rounded bg-gray-50">
                                                    <div class="text-center text-gray-500">
                                                        <i class="fas fa-chart-line text-3xl mb-2"></i>
                                                        <p>Call volume chart will appear here</p>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Performance Metrics -->
                                            <div class="bg-white border border-gray-200 rounded-lg p-6">
                                                <h4 class="text-lg font-semibold text-gray-900 mb-4">Performance Metrics</h4>
                                                <div class="space-y-4">
                                                    <div class="flex justify-between items-center">
                                                        <span class="text-sm text-gray-600">Response Time</span>
                                                        <span class="font-medium">1.8s avg</span>
                                                    </div>
                                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                                        <div class="bg-green-600 h-2 rounded-full" style="width: 75%"></div>
                                                    </div>
                                                    
                                                    <div class="flex justify-between items-center">
                                                        <span class="text-sm text-gray-600">Completion Rate</span>
                                                        <span class="font-medium">87%</span>
                                                    </div>
                                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                                        <div class="bg-blue-600 h-2 rounded-full" style="width: 87%"></div>
                                                    </div>
                                                    
                                                    <div class="flex justify-between items-center">
                                                        <span class="text-sm text-gray-600">Booking Success</span>
                                                        <span class="font-medium">85%</span>
                                                    </div>
                                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                                        <div class="bg-purple-600 h-2 rounded-full" style="width: 85%"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Recent Calls Table -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <div class="flex justify-between items-center mb-4">
                                                <h4 class="text-lg font-semibold text-gray-900">Recent Calls</h4>
                                                <div class="flex gap-2">
                                                    <button id="refreshAnalyticsBtn" class="text-indigo-600 hover:text-indigo-800 text-sm">
                                                        <i class="fas fa-refresh mr-1"></i>Refresh
                                                    </button>
                                                    <button id="exportAnalyticsBtn" class="text-indigo-600 hover:text-indigo-800 text-sm">
                                                        <i class="fas fa-download mr-1"></i>Export
                                                    </button>
                                                </div>
                                            </div>
                                            
                                            <div class="overflow-x-auto">
                                                <table class="min-w-full divide-y divide-gray-200">
                                                    <thead class="bg-gray-50">
                                                        <tr>
                                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Contact</th>
                                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">From Number</th>
                                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date & Time</th>
                                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Duration</th>
                                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody id="recentCallsBody" class="bg-white divide-y divide-gray-200">
                                                        <tr>
                                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Loading...</td>
                                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">-</td>
                                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">-</td>
                                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">-</td>
                                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">-</td>
                                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">-</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>

                                        <!-- Insights & Recommendations -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-lightbulb mr-2 text-yellow-500"></i>AI Insights & Recommendations
                                            </h4>
                                            <div id="analyticsInsights" class="space-y-3">
                                                <div class="p-3 bg-green-50 border border-green-200 rounded-lg">
                                                    <div class="flex items-start">
                                                        <div class="flex-shrink-0">
                                                            <i class="fas fa-check-circle text-green-500"></i>
                                                        </div>
                                                        <div class="ml-3">
                                                            <h5 class="text-sm font-medium text-green-800">High Call Completion Rate</h5>
                                                            <p class="text-sm text-green-700">Your agent is successfully completing 87% of calls, which is above industry average.</p>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div class="p-3 bg-yellow-50 border border-yellow-200 rounded-lg">
                                                    <div class="flex items-start">
                                                        <div class="flex-shrink-0">
                                                            <i class="fas fa-exclamation-triangle text-yellow-500"></i>
                                                        </div>
                                                        <div class="ml-3">
                                                            <h5 class="text-sm font-medium text-yellow-800">Optimize Response Time</h5>
                                                            <p class="text-sm text-yellow-700">Average response time is 1.8s. Consider simplifying complex prompts to reach the 1.5s target.</p>
                                                            <button class="text-yellow-800 hover:text-yellow-900 text-xs mt-1 underline">Review prompt complexity</button>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div class="p-3 bg-red-50 border border-red-200 rounded-lg">
                                                    <div class="flex items-start">
                                                        <div class="flex-shrink-0">
                                                            <i class="fas fa-times-circle text-red-500"></i>
                                                        </div>
                                                        <div class="ml-3">
                                                            <h5 class="text-sm font-medium text-red-800">Knowledge Gap Detected</h5>
                                                            <p class="text-sm text-red-700">12 calls failed due to out-of-scope inquiries. Consider adding more Q&A entries.</p>
                                                            <button class="text-red-800 hover:text-red-900 text-xs mt-1 underline">Add knowledge entries</button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Intelligence Tab -->
                                <div id="ai-intelligence-tab" class="ai-config-tab-content hidden">
                                    <div class="space-y-6">
                                        <!-- Intelligence Overview -->
                                        <div class="bg-gradient-to-r from-purple-50 to-indigo-50 border border-purple-200 rounded-lg p-6">
                                            <div class="flex items-center justify-between mb-4">
                                                <h4 class="text-xl font-semibold text-purple-900 flex items-center">
                                                    <i class="fas fa-robot mr-3 text-2xl"></i>Super-Intelligent AI Engine
                                                </h4>
                                                <span class="bg-purple-600 text-white px-3 py-1 rounded-full text-sm font-medium">
                                                    Next-Gen AI
                                                </span>
                                            </div>
                                            <p class="text-purple-800 mb-4">
                                                Advanced AI capabilities with semantic knowledge, contextual memory, dynamic reasoning, and real-time optimization.
                                            </p>
                                            
                                            <!-- Intelligence Score -->
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                <div class="bg-white rounded-lg p-4 shadow-sm">
                                                    <h5 class="font-semibold text-gray-900 mb-3">Intelligence Score</h5>
                                                    <div class="flex items-center mb-2">
                                                        <div class="flex-1 bg-gray-200 rounded-full h-3">
                                                            <div id="intelligenceScore" class="bg-gradient-to-r from-purple-500 to-indigo-500 h-3 rounded-full" style="width: 87%"></div>
                                                        </div>
                                                        <span id="intelligenceScoreText" class="ml-3 font-bold text-lg text-purple-600">87%</span>
                                                    </div>
                                                    <p class="text-sm text-gray-600">16% above industry average</p>
                                                </div>
                                                
                                                <div class="bg-white rounded-lg p-4 shadow-sm">
                                                    <h5 class="font-semibold text-gray-900 mb-3">Response Time</h5>
                                                    <div class="flex items-center justify-between">
                                                        <span id="responseTime" class="text-2xl font-bold text-green-600">1.8s</span>
                                                        <span class="text-sm text-gray-600">Target: 1.5s</span>
                                                    </div>
                                                    <p class="text-sm text-gray-600 mt-1">28% faster than HighLevel</p>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Intelligence Features Configuration -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-brain mr-2 text-indigo-600"></i>Intelligence Features
                                            </h4>
                                            
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                <!-- Semantic Knowledge Base -->
                                                <div class="p-4 border border-gray-200 rounded-lg">
                                                    <div class="flex items-center justify-between mb-3">
                                                        <h5 class="font-medium text-gray-900 flex items-center">
                                                            <i class="fas fa-search mr-2 text-blue-600"></i>Semantic Knowledge
                                                        </h5>
                                                        <label class="relative inline-flex items-center cursor-pointer">
                                                            <input type="checkbox" id="semanticKnowledgeEnabled" class="sr-only peer" checked>
                                                            <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                                        </label>
                                                    </div>
                                                    <p class="text-sm text-gray-600 mb-3">AI searches knowledge semantically with 87% confidence threshold</p>
                                                    <div class="text-xs text-gray-500">
                                                        <div class="flex justify-between">
                                                            <span>Confidence Threshold:</span>
                                                            <span id="confidenceThresholdValue">85%</span>
                                                        </div>
                                                        <input type="range" id="confidenceThreshold" min="70" max="95" value="85" class="w-full mt-2">
                                                    </div>
                                                </div>

                                                <!-- Contextual Memory -->
                                                <div class="p-4 border border-gray-200 rounded-lg">
                                                    <div class="flex items-center justify-between mb-3">
                                                        <h5 class="font-medium text-gray-900 flex items-center">
                                                            <i class="fas fa-memory mr-2 text-green-600"></i>Contextual Memory
                                                        </h5>
                                                        <label class="relative inline-flex items-center cursor-pointer">
                                                            <input type="checkbox" id="contextualMemoryEnabled" class="sr-only peer" checked>
                                                            <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                                        </label>
                                                    </div>
                                                    <p class="text-sm text-gray-600 mb-3">Remembers caller history and personalizes responses</p>
                                                    <select id="personalizationLevel" class="text-xs w-full border border-gray-300 rounded px-2 py-1">
                                                        <option value="basic">Basic Personalization</option>
                                                        <option value="medium" selected>Medium Personalization</option>
                                                        <option value="advanced">Advanced Personalization</option>
                                                    </select>
                                                </div>

                                                <!-- Dynamic Reasoning -->
                                                <div class="p-4 border border-gray-200 rounded-lg">
                                                    <div class="flex items-center justify-between mb-3">
                                                        <h5 class="font-medium text-gray-900 flex items-center">
                                                            <i class="fas fa-lightbulb mr-2 text-yellow-600"></i>Dynamic Reasoning
                                                        </h5>
                                                        <label class="relative inline-flex items-center cursor-pointer">
                                                            <input type="checkbox" id="dynamicReasoningEnabled" class="sr-only peer" checked>
                                                            <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                                        </label>
                                                    </div>
                                                    <p class="text-sm text-gray-600 mb-3">AI reasons through complex queries using ReAct framework</p>
                                                    <div class="text-xs text-gray-500">
                                                        <span>Observe → Reason → Act</span>
                                                    </div>
                                                </div>

                                                <!-- Real-time Escalation -->
                                                <div class="p-4 border border-gray-200 rounded-lg">
                                                    <div class="flex items-center justify-between mb-3">
                                                        <h5 class="font-medium text-gray-900 flex items-center">
                                                            <i class="fas fa-user-friends mr-2 text-red-600"></i>Smart Escalation
                                                        </h5>
                                                        <label class="relative inline-flex items-center cursor-pointer">
                                                            <input type="checkbox" id="smartEscalationEnabled" class="sr-only peer" checked>
                                                            <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                                        </label>
                                                    </div>
                                                    <p class="text-sm text-gray-600">Sentiment-triggered escalation with context handoffs</p>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Performance Benchmarks -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-tachometer-alt mr-2 text-indigo-600"></i>Performance Benchmarks
                                            </h4>
                                            
                                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                                <div class="text-center p-4 bg-green-50 rounded-lg">
                                                    <div class="text-2xl font-bold text-green-600">87%</div>
                                                    <div class="text-sm text-gray-600">Confidence Rate</div>
                                                    <div class="text-xs text-green-600">+12% vs Industry</div>
                                                </div>
                                                <div class="text-center p-4 bg-blue-50 rounded-lg">
                                                    <div class="text-2xl font-bold text-blue-600">1.8s</div>
                                                    <div class="text-sm text-gray-600">Response Time</div>
                                                    <div class="text-xs text-blue-600">-28% vs HighLevel</div>
                                                </div>
                                                <div class="text-center p-4 bg-purple-50 rounded-lg">
                                                    <div class="text-2xl font-bold text-purple-600">12%</div>
                                                    <div class="text-sm text-gray-600">Escalation Rate</div>
                                                    <div class="text-xs text-purple-600">-33% vs Industry</div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Test Intelligence -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-flask mr-2 text-indigo-600"></i>Test Intelligence
                                            </h4>
                                            
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                                <div>
                                                    <label class="form-label text-sm">Test Scenario</label>
                                                    <select id="testScenario" class="form-select">
                                                        <option value="standard">Standard Query</option>
                                                        <option value="complex">Complex Question</option>
                                                        <option value="emotional">Emotional Customer</option>
                                                        <option value="urgent">Urgent Request</option>
                                                    </select>
                                                </div>
                                                <div>
                                                    <label class="form-label text-sm">Test Query</label>
                                                    <input type="text" id="testQueryIntelligence" class="form-input" placeholder="What are your emergency service hours?">
                                                </div>
                                            </div>
                                            
                                            <button id="testIntelligenceBtn" class="bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded-lg text-sm">
                                                <i class="fas fa-rocket mr-1"></i>Test Super AI
                                            </button>
                                            
                                            <div id="intelligenceTestResults" class="mt-4 hidden">
                                                <!-- Test results will be populated here -->
                                            </div>
                                        </div>

                                        <!-- Continuous Learning -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-graduation-cap mr-2 text-indigo-600"></i>Continuous Learning
                                            </h4>
                                            
                                            <div class="space-y-3">
                                                <label class="flex items-center">
                                                    <input type="checkbox" id="autoLearningEnabled" class="form-checkbox" checked>
                                                    <span class="form-check-label">Auto-update knowledge from failed queries</span>
                                                </label>
                                                <label class="flex items-center">
                                                    <input type="checkbox" id="performanceOptimization" class="form-checkbox" checked>
                                                    <span class="form-check-label">Optimize response patterns automatically</span>
                                                </label>
                                                <label class="flex items-center">
                                                    <input type="checkbox" id="abTestingEnabled" class="form-checkbox">
                                                    <span class="form-check-label">A/B test different response strategies</span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Personality Tab -->
                                <div id="ai-personality-tab" class="ai-config-tab-content hidden">
                                    <div class="space-y-6">
                                        <!-- Personality Quick Settings -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-user-friends mr-2 text-indigo-600"></i>Agent Personality
                                            </h4>
                                            
                                            <!-- Personality Presets -->
                                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                                                <button class="personality-preset-btn p-4 border-2 border-gray-200 rounded-lg hover:border-indigo-300 transition-colors" data-preset="professional">
                                                    <i class="fas fa-briefcase text-2xl text-gray-600 mb-2"></i>
                                                    <div class="font-semibold">Professional</div>
                                                    <div class="text-xs text-gray-500">Formal, courteous, business-focused</div>
                                                </button>
                                                <button class="personality-preset-btn p-4 border-2 border-gray-200 rounded-lg hover:border-indigo-300 transition-colors" data-preset="friendly">
                                                    <i class="fas fa-smile text-2xl text-gray-600 mb-2"></i>
                                                    <div class="font-semibold">Friendly</div>
                                                    <div class="text-xs text-gray-500">Warm, conversational, approachable</div>
                                                </button>
                                                <button class="personality-preset-btn p-4 border-2 border-gray-200 rounded-lg hover:border-indigo-300 transition-colors" data-preset="sales">
                                                    <i class="fas fa-chart-line text-2xl text-gray-600 mb-2"></i>
                                                    <div class="font-semibold">Sales-Focused</div>
                                                    <div class="text-xs text-gray-500">Persuasive, goal-oriented, engaging</div>
                                                </button>
                                                <button class="personality-preset-btn p-4 border-2 border-indigo-500 rounded-lg bg-indigo-50" data-preset="custom">
                                                    <i class="fas fa-cogs text-2xl text-indigo-600 mb-2"></i>
                                                    <div class="font-semibold text-indigo-900">Custom</div>
                                                    <div class="text-xs text-indigo-600">Design your own personality</div>
                                                </button>
                                            </div>

                                            <!-- Personality Settings -->
                                            <div id="personalitySettings" class="space-y-4">
                                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                                    <div>
                                                        <label class="form-label text-sm">Formality Level</label>
                                                        <select id="aiFormalityLevel" class="form-select">
                                                            <option value="casual">Casual</option>
                                                            <option value="professional" selected>Professional</option>
                                                            <option value="formal">Very Formal</option>
                                                        </select>
                                                    </div>
                                                    <div>
                                                        <label class="form-label text-sm">Response Speed</label>
                                                        <select id="aiResponseSpeed" class="form-select">
                                                            <option value="thoughtful">Thoughtful</option>
                                                            <option value="normal" selected>Normal</option>
                                                            <option value="quick">Quick</option>
                                                        </select>
                                                    </div>
                                                    <div>
                                                        <label class="form-label text-sm">Empathy Level</label>
                                                        <select id="aiEmpathyLevel" class="form-select">
                                                            <option value="low">Direct</option>
                                                            <option value="medium" selected>Balanced</option>
                                                            <option value="high">Very Empathetic</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Conversation Samples -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-comments mr-2 text-indigo-600"></i>Conversation Samples
                                            </h4>
                                            <div id="conversationSamples" class="space-y-4">
                                                <!-- Sample conversations will be populated here -->
                                            </div>
                                        </div>

                                        <!-- Link to Personality Responses -->
                                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-blue-900 mb-2 flex items-center">
                                                <i class="fas fa-link mr-2"></i>Advanced Personality Customization
                                            </h4>
                                            <p class="text-blue-700 mb-4">For detailed personality response customization, use the dedicated Personality Responses tab.</p>
                                            <button id="goToPersonalityTab" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg">
                                                <i class="fas fa-external-link-alt mr-2"></i>Open Personality Responses
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <!-- Advanced Tab -->
                                <div id="ai-advanced-tab" class="ai-config-tab-content hidden">
                                    <div class="space-y-6">
                                        <!-- Performance Settings -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-tachometer-alt mr-2 text-indigo-600"></i>Performance Settings
                                            </h4>
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                <div>
                                                    <label class="form-label">Response Mode</label>
                                                    <select id="aiResponseMode" class="form-select">
                                                        <option value="optimal" selected>Optimal (Recommended)</option>
                                                        <option value="fast">Fast Response</option>
                                                        <option value="detailed">Detailed Analysis</option>
                                                        <option value="custom">Custom Configuration</option>
                                                    </select>
                                                </div>
                                                <div>
                                                    <label class="form-label">Call Handling</label>
                                                    <select id="aiCallHandling" class="form-select">
                                                        <option value="full" selected>Full Service Agent</option>
                                                        <option value="receptionist">Receptionist Only</option>
                                                        <option value="hybrid">Hybrid Mode</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Integration Settings -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-plug mr-2 text-indigo-600"></i>Integration Settings
                                            </h4>
                                            <div class="space-y-4">
                                                <div>
                                                    <label class="flex items-center">
                                                        <input type="checkbox" id="aiCRMIntegration" class="form-checkbox">
                                                        <span class="form-check-label">CRM Integration</span>
                                                    </label>
                                                </div>
                                                <div>
                                                    <label class="flex items-center">
                                                        <input type="checkbox" id="aiCalendarSync" class="form-checkbox" checked>
                                                        <span class="form-check-label">Calendar Synchronization</span>
                                                    </label>
                                                </div>
                                                <div>
                                                    <label class="flex items-center">
                                                        <input type="checkbox" id="aiEmailNotifications" class="form-checkbox" checked>
                                                        <span class="form-check-label">Email Notifications</span>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Fallback & Escalation -->
                                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                                <i class="fas fa-life-ring mr-2 text-indigo-600"></i>Fallback & Escalation
                                            </h4>
                                            <div class="space-y-4">
                                                <div>
                                                    <label class="form-label">When Agent is Uncertain</label>
                                                    <select id="aiUncertaintyHandling" class="form-select">
                                                        <option value="ask-clarification">Ask for clarification</option>
                                                        <option value="transfer" selected>Transfer to human</option>
                                                        <option value="take-message">Take a message</option>
                                                    </select>
                                                </div>
                                                <div>
                                                    <label class="form-label">Escalation Phone Number</label>
                                                    <input type="tel" id="aiEscalationPhone" class="form-input" placeholder="+1 (555) 123-4567">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Save Actions -->
                            <div class="px-6 md:px-8 mt-8 pt-6 border-t border-gray-200">
                                <!-- Configuration Summary -->
                                <div class="mb-6 p-6 bg-gradient-to-r from-green-50 to-blue-50 border border-green-200 rounded-xl">
                                    <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                        <i class="fas fa-check-circle mr-2 text-green-600"></i>HVAC Service Script Implementation Summary
                                        <span class="ml-2 text-xs bg-green-100 text-green-800 px-2 py-1 rounded">Ready for Testing</span>
                                    </h3>
                                    
                                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4">
                                        <div class="p-3 bg-white rounded-lg shadow-sm">
                                            <div class="flex items-center justify-between">
                                                <span class="text-sm font-medium text-gray-700">Behavior Guidelines</span>
                                                <i class="fas fa-check text-green-500"></i>
                                            </div>
                                            <p class="text-xs text-gray-500 mt-1">Complete protocol implemented</p>
                                        </div>
                                        <div class="p-3 bg-white rounded-lg shadow-sm">
                                            <div class="flex items-center justify-between">
                                                <span class="text-sm font-medium text-gray-700">Scheduling Rules</span>
                                                <i class="fas fa-check text-green-500"></i>
                                            </div>
                                            <p class="text-xs text-gray-500 mt-1">Repair vs Maintenance logic</p>
                                        </div>
                                        <div class="p-3 bg-white rounded-lg shadow-sm">
                                            <div class="flex items-center justify-between">
                                                <span class="text-sm font-medium text-gray-700">Emergency Protocols</span>
                                                <i class="fas fa-check text-green-500"></i>
                                            </div>
                                            <p class="text-xs text-gray-500 mt-1">24/7 emergency handling</p>
                                        </div>
                                        <div class="p-3 bg-white rounded-lg shadow-sm">
                                            <div class="flex items-center justify-between">
                                                <span class="text-sm font-medium text-gray-700">Transfer Protocols</span>
                                                <i class="fas fa-check text-green-500"></i>
                                            </div>
                                            <p class="text-xs text-gray-500 mt-1">Service Advisor & Steven routes</p>
                                        </div>
                                        <div class="p-3 bg-white rounded-lg shadow-sm">
                                            <div class="flex items-center justify-between">
                                                <span class="text-sm font-medium text-gray-700">Time Slot Management</span>
                                                <i class="fas fa-check text-green-500"></i>
                                            </div>
                                            <p class="text-xs text-gray-500 mt-1">2-hour buffer, ET timezone</p>
                                        </div>
                                        <div class="p-3 bg-white rounded-lg shadow-sm">
                                            <div class="flex items-center justify-between">
                                                <span class="text-sm font-medium text-gray-700">Customer Information</span>
                                                <i class="fas fa-check text-green-500"></i>
                                            </div>
                                            <p class="text-xs text-gray-500 mt-1">Complete data collection flow</p>
                                        </div>
                                    </div>
                                    
                                    <div class="p-4 bg-blue-50 rounded-lg border border-blue-200">
                                        <h4 class="font-semibold text-blue-900 mb-2">📋 Implementation Notes:</h4>
                                        <ul class="text-sm text-blue-800 space-y-1">
                                            <li>• <strong>Blue text</strong> = Default/placeholder content (can be customized)</li>
                                            <li>• <strong>Black text</strong> = Developer-edited content (customized for your business)</li>
                                            <li>• All HVAC service protocols from your script are implemented</li>
                                            <li>• Emergency routing configured for 7 AM-7 PM ET business hours</li>
                                            <li>• Technician preferences (Dustin, Marcello) are supported</li>
                                            <li>• Steven Ferris transfer rules for billing/quotes configured</li>
                                        </ul>
                                    </div>
                                </div>
                                
                                <div class="flex gap-4 justify-end">
                                    <button id="aiPreviewAgentBtn" class="bg-gray-600 hover:bg-gray-700 text-white font-semibold py-3 px-6 rounded-lg shadow-md transition duration-150 ease-in-out flex items-center">
                                        <i class="fas fa-eye mr-2"></i>Preview Agent
                                    </button>
                                    <button id="aiTestCallBtn" class="bg-orange-600 hover:bg-orange-700 text-white font-semibold py-3 px-6 rounded-lg shadow-md transition duration-150 ease-in-out flex items-center">
                                        <i class="fas fa-phone mr-2"></i>Test Call
                                    </button>
                                    <button id="aiSaveConfigBtn" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg shadow-md transition duration-150 ease-in-out flex items-center">
                                        <i class="fas fa-save mr-2"></i>Save & Deploy
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <footer class="bg-white border-t border-gray-200 mt-auto">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-4 text-center text-gray-500 text-sm">
                © 2025 Chatterlinx.com All rights reserved.
            </div>
        </footer>
    </div>
    <div id="toast-notification" class="hidden"></div>

    <!-- Workflow Creation Modal -->
    <div id="workflow-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen px-4">
            <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-screen overflow-y-auto">
                <div class="px-6 py-4 border-b border-gray-200">
                    <h3 class="text-lg font-semibold text-gray-900 flex items-center">
                        <i class="fas fa-plus-circle mr-2 text-indigo-600"></i>
                        <span id="modal-title">Create New Workflow</span>
                    </h3>
                    <button id="close-modal" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                <div class="px-6 py-4">
                    <form id="workflow-form">
                        <div class="space-y-4">
                            <div>
                                <label for="workflow-name" class="block text-sm font-medium text-gray-700">Workflow Name</label>
                                <input type="text" id="workflow-name" name="name" required
                                       class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                            </div>
                            <div>
                                <label for="workflow-description" class="block text-sm font-medium text-gray-700">Description</label>
                                <textarea id="workflow-description" name="description" rows="3"
                                          class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"></textarea>
                            </div>
                            <div>
                                <label for="workflow-trigger" class="block text-sm font-medium text-gray-700">Trigger Type</label>
                                <select id="workflow-trigger" name="triggerType" required
                                        class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                    <option value="">Select a trigger...</option>
                                    <option value="manual">Manual</option>
                                    <option value="schedule">Scheduled</option>
                                    <option value="webhook">Webhook</option>
                                    <option value="call_received">Call Received</option>
                                    <option value="appointment_booked">Appointment Booked</option>
                                </select>
                            </div>
                            <div id="trigger-config" class="hidden">
                                <label for="trigger-config-input" class="block text-sm font-medium text-gray-700">Trigger Configuration</label>
                                <input type="text" id="trigger-config-input" name="triggerConfig"
                                       placeholder="Enter trigger configuration..."
                                       class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                            </div>
                        </div>
                    </form>
                </div>
                <div class="px-6 py-4 border-t border-gray-200 flex justify-end space-x-3">
                    <button id="cancel-workflow" type="button" class="bg-gray-300 hover:bg-gray-400 text-gray-700 font-semibold py-2 px-4 rounded-lg transition duration-150 ease-in-out">
                        Cancel
                    </button>
                    <button id="save-workflow" type="button" class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-150 ease-in-out">
                        <i class="fas fa-save mr-2"></i>Create Workflow
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Basic mobile menu toggle
        document.getElementById('mobile-menu-button')?.addEventListener('click', () => {
            document.getElementById('mobile-menu')?.classList.toggle('hidden');
        });

        // Active Nav Link Highlighting & Main Page Tab Logic
        document.addEventListener('DOMContentLoaded', function() {
            // --- Navigation Link Highlighting ---
            let currentPath = window.location.pathname.replace(/\/$/, "") || "/index.html";
            document.querySelectorAll('header nav a.nav-link, #mobile-menu a.nav-link').forEach(link => {
                let linkPath = new URL(link.href).pathname.replace(/\/$/, "") || "/index.html";
                link.classList.remove('active-tab', 'text-gray-700');
                if (linkPath === currentPath || (link.href.includes("company-profile.html") && window.location.href.includes("company-profile.html"))) {
                    link.classList.add('active-tab');
                } else {
                    link.classList.add('text-gray-700');
                }
            });

            // --- Company Profile Tab Switching ---
            const tabContainer = document.querySelector('nav[aria-label="Tabs"]');
            const contentContainer = document.getElementById('tab-content-area');
            if (tabContainer && contentContainer) {
                const tabButtons = tabContainer.querySelectorAll('.tab-button');
                const tabContents = contentContainer.querySelectorAll('.tab-content-item');

                const activateTab = (targetTabId) => {
                    tabButtons.forEach(button => {
                        const isTarget = button.dataset.tab === targetTabId;
                        button.classList.toggle('tab-button-active', isTarget);
                        button.classList.toggle('tab-button-inactive', !isTarget);
                    });
                    tabContents.forEach(content => {
                        const contentTabId = content.id.replace('-content', '');
                        content.classList.toggle('hidden', contentTabId !== targetTabId);
                    });
                    localStorage.setItem('activeCompanyProfileTab', targetTabId);
                };

                tabButtons.forEach(clickedButton => {
                    clickedButton.addEventListener('click', () => {
                        activateTab(clickedButton.dataset.tab);
                    });
                });

                // Restore active tab from localStorage or default to 'overview'
                const savedTab = localStorage.getItem('activeCompanyProfileTab');
                const initialTab = document.getElementById(`tab-${savedTab}`) ? savedTab : 'overview';
                activateTab(initialTab);
            }

            // Toast notification function
            function showToast(message, type = 'info') {
                const toast = document.getElementById('toast-notification');
                if (toast) {
                    toast.textContent = message;
                    toast.className = type === 'error' ? 'error' : type === 'success' ? 'success' : '';
                    toast.classList.remove('hidden');
                    toast.classList.add('show');
                    
                    setTimeout(() => {
                        toast.classList.remove('show');
                        setTimeout(() => toast.classList.add('hidden'), 500);
                    }, 3000);
                }
            }
        });
    </script>

    <!-- Learning Management Modals -->
    <!-- Suggestion Review Modal -->
    <div id="suggestion-review-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
        <div class="relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white">
            <div class="mt-3">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-medium text-gray-900">Review AI Suggestion</h3>
                    <button type="button" id="close-suggestion-modal" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div id="suggestion-content" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Question</label>
                        <div id="suggestion-question" class="p-3 bg-gray-50 rounded border text-sm"></div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Suggested Answer</label>
                        <textarea id="suggestion-answer" rows="6" class="w-full p-3 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500"></textarea>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Category</label>
                            <select id="suggestion-category" class="w-full p-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500">
                                <option value="general">General</option>
                                <option value="pricing">Pricing</option>
                                <option value="services">Services</option>
                                <option value="policies">Policies</option>
                                <option value="scheduling">Scheduling</option>
                                <option value="technical">Technical</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Confidence</label>
                            <div id="suggestion-confidence" class="p-2 bg-gray-50 rounded border text-sm font-medium"></div>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Tags (comma-separated)</label>
                        <input type="text" id="suggestion-tags" class="w-full p-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500" placeholder="customer service, booking, etc.">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Review Notes (optional)</label>
                        <textarea id="suggestion-review-notes" rows="3" class="w-full p-3 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500" placeholder="Notes about this suggestion..."></textarea>
                    </div>
                </div>
                
                <div class="flex justify-end space-x-3 mt-6">
                    <button type="button" id="reject-suggestion-btn" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition">
                        <i class="fas fa-times mr-1"></i> Reject
                    </button>
                    <button type="button" id="approve-suggestion-btn" class="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition">
                        <i class="fas fa-check mr-1"></i> Approve & Add
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Knowledge Entry Edit Modal -->
    <div id="knowledge-edit-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
        <div class="relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white">
            <div class="mt-3">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-medium text-gray-900">Edit Knowledge Entry</h3>
                    <button type="button" id="close-knowledge-modal" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div id="knowledge-edit-content" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Question</label>
                        <textarea id="edit-knowledge-question" rows="3" class="w-full p-3 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500"></textarea>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Answer</label>
                        <textarea id="edit-knowledge-answer" rows="6" class="w-full p-3 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500"></textarea>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Category</label>
                            <select id="edit-knowledge-category" class="w-full p-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500">
                                <option value="general">General</option>
                                <option value="pricing">Pricing</option>
                                <option value="services">Services</option>
                                <option value="policies">Policies</option>
                                <option value="scheduling">Scheduling</option>
                                <option value="technical">Technical</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Status</label>
                            <select id="edit-knowledge-status" class="w-full p-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500">
                                <option value="true">Active</option>
                                <option value="false">Inactive</option>
                            </select>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Tags (comma-separated)</label>
                        <input type="text" id="edit-knowledge-tags" class="w-full p-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500" placeholder="customer service, booking, etc.">
                    </div>
                </div>
                
                <div class="flex justify-end space-x-3 mt-6">
                    <button type="button" id="delete-knowledge-btn" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition">
                        <i class="fas fa-trash mr-1"></i> Delete
                    </button>
                    <button type="button" id="cancel-knowledge-edit-btn" class="px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition">
                        Cancel
                    </button>
                    <button type="button" id="save-knowledge-btn" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition">
                        <i class="fas fa-save mr-1"></i> Save Changes
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="/js/company-profile.js"></script>
    <script src="/js/ai-agent-setup.js"></script>
    <script>
    // ===========================================
    // PHONE NUMBER MANAGEMENT FUNCTIONALITY
    // ===========================================

    /**
     * Add a new phone number to the configuration
     */
    function addPhoneNumber() {
        const phoneNumbersList = document.getElementById('phoneNumbersList');
        const template = document.getElementById('phoneNumberTemplate');
        
        if (template && phoneNumbersList) {
            const clone = template.content.cloneNode(true);
            phoneNumbersList.appendChild(clone);
            
            // Show success message
            showToast('New phone number slot added', 'success');
        }
    }

    /**
     * Remove a phone number from the configuration
     */
    function removePhoneNumber(button) {
        const phoneItem = button.closest('.phone-number-item');
        const isPrimary = phoneItem.querySelector('.bg-blue-100.text-blue-800');
        
        if (isPrimary && isPrimary.textContent.includes('Primary')) {
            showToast('Cannot remove primary number. Set another number as primary first.', 'error');
            return;
        }
        
        if (confirm('Are you sure you want to remove this phone number?')) {
            phoneItem.remove();
            updateAIAgentPhoneOptions();
            showToast('Phone number removed', 'success');
        }
    }

    /**
     * Set a phone number as the primary number
     */
    function setPrimaryNumber(button) {
        const phoneItem = button.closest('.phone-number-item');
        const phoneNumberInput = phoneItem.querySelector('input[name="phoneNumber"]');
        
        if (!phoneNumberInput.value.trim()) {
            showToast('Please enter a phone number first', 'error');
            return;
        }
        
        // Remove primary badge from all items
        document.querySelectorAll('.phone-number-item').forEach(item => {
            const badge = item.querySelector('.bg-blue-100.text-blue-800');
            const setPrimaryBtn = item.querySelector('button[onclick*="setPrimaryNumber"]');
            
            if (badge && badge.textContent.includes('Primary')) {
                badge.textContent = 'Set Primary';
                badge.className = 'bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full hover:bg-blue-200';
                badge.onclick = () => setPrimaryNumber(badge);
            }
        });
        
        // Set this item as primary
        button.textContent = 'Primary';
        button.className = 'bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full';
        button.onclick = null;
        
        // Update AI Agent Setup options
        updateAIAgentPhoneOptions();
        showToast('Primary number updated', 'success');
    }

    /**
     * Update phone number options in AI Agent Setup tab
     */
    function updateAIAgentPhoneOptions() {
        const phoneNumbers = getConfiguredPhoneNumbers();
        const primarySelect = document.getElementById('primaryPhoneNumber');
        const backupSelect = document.getElementById('backupPhoneNumber');
        const numbersList = document.getElementById('configuredNumbersList');
        
        // Update primary phone number select
        if (primarySelect) {
            const currentValue = primarySelect.value;
            primarySelect.innerHTML = '<option value="">Select primary number...</option>';
            
            phoneNumbers.forEach(phone => {
                if (phone.status === 'active') {
                    const option = document.createElement('option');
                    option.value = phone.number;
                    option.textContent = `${phone.number} (${phone.friendlyName})`;
                    if (phone.isPrimary) {
                        option.selected = true;
                    }
                    primarySelect.appendChild(option);
                }
            });
            
            // Restore previous selection if still valid
            if (currentValue && [...primarySelect.options].some(opt => opt.value === currentValue)) {
                primarySelect.value = currentValue;
            }
        }
        
        // Update backup phone number select
        if (backupSelect) {
            const currentValue = backupSelect.value;
            backupSelect.innerHTML = '<option value="">Select backup number...</option><option value="none">No backup number</option>';
            
            phoneNumbers.forEach(phone => {
                if (phone.status === 'active') {
                    const option = document.createElement('option');
                    option.value = phone.number;
                    option.textContent = `${phone.number} (${phone.friendlyName})`;
                    backupSelect.appendChild(option);
                }
            });
            
            // Restore previous selection if still valid
            if (currentValue && [...backupSelect.options].some(opt => opt.value === currentValue)) {
                backupSelect.value = currentValue;
            }
        }
        
        // Update available numbers display
        if (numbersList) {
            if (phoneNumbers.length === 0) {
                numbersList.innerHTML = '<div class="text-sm text-gray-500 italic">No phone numbers configured. Please add numbers in the Configuration tab.</div>';
            } else {
                numbersList.innerHTML = phoneNumbers.map(phone => `
                    <div class="flex items-center justify-between p-2 bg-gray-50 rounded border">
                        <span class="text-sm">
                            <strong>${phone.number}</strong> - ${phone.friendlyName}
                            ${phone.isPrimary ? '<span class="ml-2 bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full">Primary</span>' : ''}
                        </span>
                        <span class="text-xs px-2 py-1 rounded-full ${phone.status === 'active' ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-600'}">
                            ${phone.status}
                        </span>
                    </div>
                `).join('');
            }
        }
    }

    /**
     * Get all configured phone numbers
     */
    function getConfiguredPhoneNumbers() {
        const phoneItems = document.querySelectorAll('.phone-number-item');
        const phoneNumbers = [];
        
        phoneItems.forEach(item => {
            const numberInput = item.querySelector('input[name="phoneNumber"]');
            const nameInput = item.querySelector('input[name="friendlyName"]');
            const statusSelect = item.querySelector('select[name="status"]');
            const isPrimaryBadge = item.querySelector('.bg-blue-100.text-blue-800');
            
            if (numberInput && numberInput.value.trim()) {
                phoneNumbers.push({
                    number: numberInput.value.trim(),
                    friendlyName: nameInput ? nameInput.value.trim() || 'Unnamed' : 'Unnamed',
                    status: statusSelect ? statusSelect.value : 'active',
                    isPrimary: isPrimaryBadge && isPrimaryBadge.textContent.includes('Primary')
                });
            }
        });
        
        return phoneNumbers;
    }

    /**
     * Switch to configuration tab from AI Agent Setup
     */
    function switchToConfigTab() {
        // Switch to Configuration tab
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        document.querySelectorAll('.tab-content').forEach(content => {
            content.classList.add('hidden');
        });
        
        // Activate Configuration tab
        const configBtn = document.querySelector('[data-tab="configuration"]');
        const configContent = document.getElementById('configuration');
        
        if (configBtn) configBtn.classList.add('active');
        if (configContent) configContent.classList.remove('hidden');
        
        // Scroll to phone numbers section
        setTimeout(() => {
            const phoneSection = document.getElementById('phoneNumbersList');
            if (phoneSection) {
                phoneSection.scrollIntoView({ behavior: 'smooth', block: 'center' });
                
                // Highlight the section briefly
                phoneSection.style.background = '#FEF3C7';
                setTimeout(() => {
                    phoneSection.style.background = '';
                }, 2000);
            }
        }, 100);
    }

    /**
     * Toast notification function
     */
    function showToast(message, type = 'info') {
        const toast = document.createElement('div');
        toast.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 ${
            type === 'success' ? 'bg-green-500' : 
            type === 'error' ? 'bg-red-500' : 
            'bg-blue-500'
        } text-white`;
        toast.textContent = message;

        document.body.appendChild(toast);

        setTimeout(() => {
            toast.remove();
        }, 3000);
    }

    // Initialize phone number management when DOM is ready
    document.addEventListener('DOMContentLoaded', function() {
        // Add event listener for add phone number button
        const addPhoneBtn = document.getElementById('addPhoneNumberBtn');
        if (addPhoneBtn) {
            addPhoneBtn.addEventListener('click', addPhoneNumber);
        }
        
        // Update AI Agent Setup options when page loads
        updateAIAgentPhoneOptions();
        
        // Listen for changes in phone number inputs to update AI Agent Setup
        document.addEventListener('input', function(e) {
            if (e.target.matches('.phone-number-item input, .phone-number-item select')) {
                // Debounce the update
                clearTimeout(window.phoneUpdateTimeout);
                window.phoneUpdateTimeout = setTimeout(updateAIAgentPhoneOptions, 500);
            }
        });
    });

// ===========================================
// WEBHOOK CONFIGURATION PANEL
// ===========================================

/**
 * Toggle webhook information panel
 */
function toggleWebhookPanel() {
    const panel = document.getElementById('webhookInfoPanel');
    const toggleBtn = document.getElementById('toggleWebhookInfo');
    
    if (panel && toggleBtn) {
        const isHidden = panel.classList.contains('hidden');
        
        if (isHidden) {
            panel.classList.remove('hidden');
            toggleBtn.innerHTML = '<i class="fas fa-eye-slash mr-1"></i>Hide Webhook URLs';
        } else {
            panel.classList.add('hidden');
            toggleBtn.innerHTML = '<i class="fas fa-info-circle mr-1"></i>Show Webhook URLs';
        }
    }
}

/**
 * Copy webhook URL to clipboard
 */
async function copyWebhookUrl(webhookUrl, button) {
    try {
        await navigator.clipboard.writeText(webhookUrl);
        
        // Visual feedback
        const originalText = button.innerHTML;
        button.innerHTML = '<i class="fas fa-check mr-1"></i>Copied!';
        button.classList.remove('bg-blue-100', 'hover:bg-blue-200', 'text-blue-700');
        button.classList.add('bg-green-100', 'text-green-700');
        
        setTimeout(() => {
            button.innerHTML = originalText;
            button.classList.remove('bg-green-100', 'text-green-700');
            button.classList.add('bg-blue-100', 'hover:bg-blue-200', 'text-blue-700');
        }, 2000);
        
        showToast('Webhook URL copied to clipboard!', 'success');
    } catch (error) {
        console.error('Failed to copy webhook URL:', error);
        showToast('Failed to copy URL. Please copy manually.', 'error');
    }
}

// Initialize webhook configuration panel
document.addEventListener('DOMContentLoaded', function() {
    // Toggle webhook panel
    const toggleBtn = document.getElementById('toggleWebhookInfo');
    if (toggleBtn) {
        toggleBtn.addEventListener('click', toggleWebhookPanel);
    }
    
    // Copy webhook buttons
    document.addEventListener('click', function(e) {
        if (e.target.matches('.copy-webhook-btn, .copy-webhook-btn *')) {
            const button = e.target.closest('.copy-webhook-btn');
            const webhookUrl = button.getAttribute('data-webhook');
            if (webhookUrl) {
                copyWebhookUrl(webhookUrl, button);
            }
        }
    });
});

// ...existing code...
    </script>
</body>
</html>
